<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en" xml:lang="en" data-mc-search-type="Stem" data-mc-help-system-file-name="CygNet.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Scripting|CxEls|ElsClient Object">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>ElsClient Methods</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/NoBorder.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/HelpTable2.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/NoBorder8.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/HTML5.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><a class="MCBreadcrumbsLink" href="CygNet Scripting.htm">Scripting</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="CxEls.htm">CxEls</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="CxEls ElsClient Object.htm">ElsClient Object</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">ElsClient Methods</span>
        </div>
        <h2>ElsClient Methods</h2>
        <p>The <b>ElsClient</b> object contains the following methods:</p>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/NoBorder.css');" class="TableStyle_NoBorder" cellspacing="0">
            <col />
            <col />
            <tr>
                <td class="TableStyle_NoBorder_Body_0_0_RowSep_ColSep">
                    <ul>
                        <li class="HyperlinkList" value="1"><a href="#AddEvent" class="selected">AddEventRecord</a>
                        </li>
                        <li class="HyperlinkList" value="2"><a href="#Connect" class="selected">Connect</a>
                        </li>
                        <li class="HyperlinkList" value="3"><a href="#DeleteEv" class="selected">DeleteEventRecord</a>
                        </li>
                        <li class="HyperlinkList" value="4"><a href="#Disconne" class="selected">Disconnect</a>
                        </li>
                        <li class="HyperlinkList" value="5"><a href="#GetConsoleData" class="selected">GetConsoleData</a>
                        </li>
                        <li class="HyperlinkList" value="6"><a href="#GetEmpty" class="selected">GetEmptyRecordXml</a>
                        </li>
                        <li class="HyperlinkList" value="7"><a href="#GetRecor" class="selected">GetRecordXMLAttribute</a>
                        </li>
                        <li class="HyperlinkList" value="8"><a href="#GetReferences" class="selected">GetReferences</a>
                        </li>
                    </ul>
                </td>
                <td class="TableStyle_NoBorder_Body_0_0_RowSep_ColEnd">
                    <ul>
                        <li class="HyperlinkList" value="1"><a href="#ReadEven" class="selected">ReadEventComment</a>
                        </li>
                        <li class="HyperlinkList" value="2"><a href="#ReadEven2" class="selected">ReadEventRecords</a>
                        </li>
                        <li class="HyperlinkList" value="3"><a href="#ReadEven3" class="selected">ReadEventRecordsXmlArray</a>
                        </li>
                        <li class="HyperlinkList" value="4"><a href="#ReadUser" class="selected">ReadUserFlags</a>
                        </li>
                        <li class="HyperlinkList" value="5"><a href="#SetRecor" class="selected">SetRecordXMLAttribute</a>
                        </li>
                        <li class="HyperlinkList" value="6"><a href="#UpdateEv" class="selected">UpdateEventComment</a>
                        </li>
                        <li class="HyperlinkList" value="7"><a href="#UpdateUs" class="selected">UpdateUserFlag</a>
                        </li>
                        <li class="HyperlinkList" value="8"><a href="#UpdateUserFlags" class="selected">UpdateUserFlags</a>
                        </li>
                    </ul>
                </td>
            </tr>
        </table>
        <h3><a name="AddEvent"></a>AddEventRecord</h3>
        <p>The <b>AddEventRecord</b> method adds an event to the ELS.</p>
        <h4>Syntax</h4>
        <p class="Syntax">AddEventRecord(<i>RecordXml</i> as String) As String</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>RecordXml</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>An XML representation of the record to add to the ELS.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>The RecordXml parameter of this method can be built using the methods <a href="#GetEmpty" class="selected">GetEmptyRecordXml</a> and <a href="#SetRecor" class="selected">SetRecordXMLAttribute</a>.</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example builds a record XML and adds it to the ELS.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub</p>
                    <p class="Code2">Dim strXml</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">strXml = ElsClient.GetEmptyRecordXml</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "description", "My Description")</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "details", "My Details")</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "comments", "My Comments")</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "eventtimelocal", "3/10/2011 16:03:39.431")</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "userflag01", "true")</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">MsgBox strXml</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">Dim strDbKey</p>
                    <p class="Code2">strDbKey = ElsClient.AddEventRecord(strXml)</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">MsgBox strDbKey</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="Connect"></a>Connect</h3>
        <p>The <b>Connect</b> method connects the object to a service.</p>
        <h4>Syntax</h4>
        <p class="Syntax">Connect(<i>DomainSiteService</i> As String)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 171px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 100px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>DomainSiteService</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The <i>[Domain]Site.Service</i> to which to connect.&#160; A domain is optional. The service must be a valid ELS.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>Returns 0 if successful and a non-zero value if the connection failed.</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example connects the ElsClient object to the CYGDEMO.ELS on domain 5410:</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub ElsConnect()</p>
                    <p class="Code2">'Connect to an ELS</p>
                    <p class="Code2">Dim ElsClient</p>
                    <p class="Code2">Set ElsClient = CreateObject("CxEls.ElsClient")</p>
                    <p class="Code2">ElsClient.Connect("[5410]CYGDEMO.ELS")</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="DeleteEv"></a>DeleteEventRecord</h3>
        <p>The <b>DeleteEventRecord</b> method deletes an event from the ELS.</p>
        <h4>Syntax</h4>
        <p class="Syntax">DeleteEventRecord(<i>DbKey</i> as String) As Boolean</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>DbKey</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The database key of the record to delete.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>This method returns false if the record was successfully deleted.</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example deletes record 0000022430 from the ELS.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub</p>
                    <p class="Code2">Dim bRet</p>
                    <p class="Code2">bRet = ElsClient.DeleteEventRecord("0000022430")</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">If Not(bRet) Then</p>
                    <p class="Code2">MsgBox "Event record deleted"</p>
                    <p class="Code2">Else</p>
                    <p class="Code2">MsgBox "Event record not deleted"</p>
                    <p class="Code2">End If</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="Disconne"></a>Disconnect</h3>
        <p>The <b>Disconnect</b> method disconnects from the service.</p>
        <h4>Syntax</h4>
        <p class="Syntax">Disconnect()</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example disconnects the client from the connected service.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub ElsDisconnect()</p>
                    <p class="Code2">ElsClient.Disconnect()</p>
                    <p class="Code2">MsgBox "ElsClient has disconnected"</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetConsoleData"></a>GetConsoleData</h3>
        <p>The <b>GetConsoleData</b> method returns the console text and display attributes as two 25x80 arrays of unsigned characters. </p>
        <h4>Syntax</h4>
        <p class="Syntax">GetConsoleData(ByRef <i>pText</i>, ByRef <i>pAttr</i>) As Integer</p>
        <h4>Parameters</h4>
        <table style="mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;margin-left: 0;margin-right: auto;caption-side: top;" class="TableStyle-HelpTable2" cellspacing="0">
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>pText</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>A two-dimensional 25x80 array of console text attributes returned by this method.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>pAttr</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>A two-dimensional 25x80 array of console display attributes returned by this method.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>This method returns 0 if successful.</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example writes the console text and display attributes to a CSV file.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub</p>
                    <p class="Code2">Dim aryText, aryAttr, nRet</p>
                    <p class="Code2">nRet = ElsClient.GetConsoleData(aryText, aryAttr)</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">' Write text attributes to CSV file</p>
                    <p class="Code2">Dim i, j, strMsg</p>
                    <p class="Code3">For i = 0 To UBound(aryText, 1)</p>
                    <p class="Code3">For j = 0 To UBound(aryText, 2)</p>
                    <p class="Code4">strMsg = strMsg + CStr(aryText(i, j)) + ","</p>
                    <p class="Code3">Next</p>
                    <p class="Code4">strMsg = strMsg + vbCr</p>
                    <p class="Code2">Next</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">dim fso, file</p>
                    <p class="Code2">Set fso = CreateObject("Scripting.FileSystemObject")</p>
                    <p class="Code2">Set file = fso.OpenTextFile("c:\console_text_attrs.csv", 2, True)</p>
                    <p class="Code2">file.WriteLine(strMsg)</p>
                    <p class="Code2">file.Close </p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">strMsg = ""</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">' Write display attributes to CSV file</p>
                    <p class="Code3">For i = 0 To UBound(aryAttr, 1)</p>
                    <p class="Code3">For j = 0 To UBound(aryAttr, 2)</p>
                    <p class="Code4">strMsg = strMsg + CStr(aryAttr(i, j)) + ","</p>
                    <p class="Code3">Next</p>
                    <p class="Code4">strMsg = strMsg + vbCr</p>
                    <p class="Code2">Next</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">Set file = fso.OpenTextFile("c:\console_disp_attrs.csv", 2, True)</p>
                    <p class="Code2">file.WriteLine(strMsg)</p>
                    <p class="Code2">file.Close </p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">MsgBox nRet</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetEmpty"></a>GetEmptyRecordXml</h3>
        <p>The <b>GetEmptyRecordXml</b> method returns an empty ELS header record.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetEmptyRecordXml() As String</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example builds a record XML and adds it to the ELS.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub</p>
                    <p class="Code2">Dim strXml</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">strXml = ElsClient.GetEmptyRecordXml</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "description", "My Description")</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "details", "My Details")</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "comments", "My Comments")</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "eventtimelocal", "3/10/2011 16:03:39.431")</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "userflag01", "true")</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">MsgBox strXml</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">Dim strDbKey</p>
                    <p class="Code2">strDbKey = ElsClient.AddEventRecord(strXml)</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">MsgBox strDbKey</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetRecor"></a>GetRecordXMLAttribute</h3>
        <p>The <b>GetRecordXMLAttribute</b> method returns the value of a specified attribute in the specified record XML.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetRecordXMLAttribute(<i>RecordXml</i> as String, <i>RecordAttribute</i> as String) As String</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>RecordXml</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>An XML representation of the record from which to retrieve an attribute.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>RecordAttribute</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The attribute to retrieve from the record.&#160; This parameter can be one of the following values:</p>
                    <ul class="table">
                        <li value="1">"lock_user" — Lock User</li>
                        <li value="2">"lock_time" — Lock Time</li>
                        <li value="3">"key" — Lock Key</li>
                        <li value="4">"eventtype" — Event Type</li>
                        <li value="5">"source" — Source</li>
                        <li value="6">"category" — Category</li>
                        <li value="7">"description" — Description</li>
                        <li value="8">"details" — Details</li>
                        <li value="9">"comments" — Comments</li>
                        <li value="10">"eventtime" — Event Time</li>
                        <li value="11">"eventtimelocal" — Event Time (local)</li>
                        <li value="12">"userflag01" — User Flag 01</li>
                        <li value="13">"userflag02" — User Flag 02</li>
                        <li value="14">"userflag03" — User Flag 03</li>
                        <li value="15">"userflag04" — User Flag 04</li>
                        <li value="16">"userflag05" — User Flag 05</li>
                        <li value="17">"userflag06" — User Flag 06</li>
                        <li value="18">"userflag07" — User Flag 07</li>
                        <li value="19">"userflag08" — User Flag 08</li>
                        <li value="20">"userflag09" — User Flag 09</li>
                    </ul>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p class="Indent">The following example displays the value of the "eventtimelocal" attribute for record 0000022430.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub</p>
                    <p class="Code2">Dim aryDbKeys, aryXml, strAttr</p>
                    <p class="Code2">ReDim aryDbKeys(0)</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">aryDbKeys(0) = "0000022430"</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">aryXml = ElsClient.ReadEventRecordsXmlArray(aryDbKeys)</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">strAttr = ElsClient.GetRecordXMLAttribute(aryXml(0), "eventtimelocal")</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code">MsgBox strAttr</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetReferences"></a>GetReferences</h3>
        <p>The <b>GetReferences</b> method refreshes the list of services referenced by the connected service.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetReferences()</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example refreshes the connected services.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub getElsReferences()</p>
                    <p class="Code2">ElsClient.GetReferences()</p>
                    <p class="Code2">MsgBox "Services referenced retrieved"</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="ReadEven"></a>ReadEventComment</h3>
        <p>The <b>ReadEventComment</b> method returns the comment for a record as an XML formatted string.</p>
        <h4>Syntax</h4>
        <p class="Syntax">ReadEventComment(<i>Key</i> As String) As String</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>Key</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>A valid Level 2 DbKey.</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p class="Indent">The following example gets the comment from a DbKey.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub readComments()</p>
                    <p class="Code2">Dim key</p>
                    <p class="Code2">Dim comment</p>
                    <p class="Code2">key = "0000000034"</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">comment = ElsClient.ReadEventComment(key)</p>
                    <p class="Code2">MsgBox comment</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="ReadEven2"></a>ReadEventRecords</h3>
        <p>The <b>ReadEventRecords</b> method returns the header record fields as an XML string.</p>
        <h4>Syntax</h4>
        <p class="Syntax">ReadEventRecords(<i>DbKeys</i> As Array) As String</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>DbKeys</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>An array of valid Level 2 DbKeys.</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p class="Indent">The following example gets header records from two DbKeys and stores them in an XML document.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub readRecords()</p>
                    <p class="Code2">Dim Keys(1)</p>
                    <p class="Code2">Dim headersXml</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">Keys(0) = "0000000034"</p>
                    <p class="Code2">Keys(1) = "0000000036"</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">headersXml = ElsClient.ReadEventRecords(Keys)</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">'Save header records as XML</p>
                    <p class="Code2">Set xmlDoc = CreateObject("Msxml2.DOMDocument.5.0")</p>
                    <p class="Code2">xmlDoc.loadXML(headersXml)</p>
                    <p class="Code2">xmlDoc.save("C:\HeaderRecords.xml")</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="ReadEven3"></a>ReadEventRecordsXmlArray</h3>
        <p>The <b>ReadEventRecords</b> method returns the header record fields as an array of XML strings.</p>
        <h4>Syntax</h4>
        <p class="Syntax">ReadEventRecordsXmlArray(<i>DbKeys</i> As Array) As Variant</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>DbKeys</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>An array of valid Level 2 DbKeys.</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p class="Indent">The following example gets header records from two DbKeys. It then displays the first record in a list box and saves the second record to the hard drive.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub readRecordArray()</p>
                    <p class="Code2">Dim Keys(1)</p>
                    <p class="Code2">Dim arrHeaders</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">Keys(0) = "0000000034"</p>
                    <p class="Code2">Keys(1) = "0000000036"</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">arrHeaders = ElsClient.ReadEventRecordsXmlArray(Keys)</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">'Display the first record</p>
                    <p class="Code2">lboList.AddString(arrHeaders(0))</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">'Save the second record to the hard drive</p>
                    <p class="Code2">Set xmlDoc = CreateObject("Msxml2.DOMDocument.5.0")</p>
                    <p class="Code2">xmlDoc.loadXML(arrHeaders(1))</p>
                    <p class="Code2">xmlDoc.save("C:\HeaderRecordXml.xml")</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="ReadUser"></a>ReadUserFlags</h3>
        <p>The <b>ReadUserFlags</b> method takes a valid Event Logging Service database key and returns an array of the user flag values.</p>
        <h4>Syntax</h4>
        <p class="Syntax">ReadUserFlags(<i>DbKey</i> As String)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>DbKey</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>A valid Level 1 DBKey for the record to update in a string form.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p><i>Return Value:</i>&#160; An array of the current user flag values.  Each Entry in the array represents a single flag.  The value of each entry is True if the flag is set, False if the flag is not set.   The array index is zero based, so index 0 is UserFlag01 and index 9 is UserFlag10, or one less than the name.</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example gets the user flag values for DbKey 0000000282 and displays a message box with UserFlag07’s state.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Dim ElsClient</p>
                    <p class="Code">Dim arrFlags</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'Create the Els Client Object</p>
                    <p class="Code">ElsClient = CreateObject("CxEls.ElsClient" )</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'Connect to the appropriate ELS</p>
                    <p class="Code">ElsClient.Connect "MYSITE.ELS"</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'Read the current user flags on DbKey 0000000282</p>
                    <p class="Code">arrFlags  = m_ElsClient.ReadUserFlags( "0000000282")</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'Now show the current flag value for UserFlag07</p>
                    <p class="Code">If arrFlags(6) Then</p>
                    <p class="Code2">MsgBox "UserFlag07 is Set"</p>
                    <p class="Code">Else</p>
                    <p class="Code2">MsgBox "UserFlag07 is not Set"</p>
                    <p class="Code">End If</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="SetRecor"></a>SetRecordXMLAttribute</h3>
        <p>The <b>SetRecordXMLAttribute</b> method sets the value of a specified attribute in the specified record XML.</p>
        <h4>Syntax</h4>
        <p class="Syntax">SetRecordXMLAttribute(<i>RecordXml</i> as String, <i>RecordAttribute</i> as String, <i>AttributeValue</i> as String) As String</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>RecordXml</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>An XML representation of the record for which to set an attribute.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>RecordAttribute</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The attribute to set in the record.&#160; This parameter can be one of the following values:</p>
                    <ul class="table">
                        <li value="1">"eventtype" — Event Type</li>
                        <li value="2">"source" — Source</li>
                        <li value="3">"category" — Category</li>
                        <li value="4">"description" — Description</li>
                        <li value="5">"details" — Details</li>
                        <li value="6">"comments" — Comments</li>
                        <li value="7">"eventtimelocal" — Event Time (local)</li>
                        <li value="8">"userflag01" — User Flag 01</li>
                        <li value="9">"userflag02" — User Flag 02</li>
                        <li value="10">"userflag03" — User Flag 03</li>
                        <li value="11">"userflag04" — User Flag 04</li>
                        <li value="12">"userflag05" — User Flag 05</li>
                        <li value="13">"userflag06" — User Flag 06</li>
                        <li value="14">"userflag07" — User Flag 07</li>
                        <li value="15">"userflag08" — User Flag 08</li>
                        <li value="16">"userflag09" — User Flag 09</li>
                    </ul>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>AttributeValue</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The value of the attribute to set.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p><i>Return Value:</i>&#160; A string containing the new record XML with the updated attribute.</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example builds a record XML and adds it to the ELS.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub</p>
                    <p class="Code2">Dim strXml</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">strXml = ElsClient.GetEmptyRecordXml</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "description", "My Description")</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "details", "My Details")</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "comments", "My Comments")</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "eventtimelocal", "3/10/2011 16:03:39.431")</p>
                    <p class="Code2">strXml = ElsClient.SetRecordXMLAttribute(_</p>
                    <p class="Code2">strXml, "userflag01", "true")</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">MsgBox strXml</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">Dim strDbKey</p>
                    <p class="Code2">strDbKey = ElsClient.AddEventRecord(strXml)</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">MsgBox strDbKey</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="UpdateEv"></a>UpdateEventComment</h3>
        <p>The <b>UpdateEventComment</b> method adds a comment to a record.</p>
        <h4>Syntax</h4>
        <p class="Syntax">UpdateEventComment(<i>DbKey</i> As String, <i>Comment</i> As String)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>DbKey</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>A valid Level 2 DbKey.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>Comment</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>A string comment to add to the record.</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p class="Indent">The following example adds a comment to a ELS record.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub updateElsComment()</p>
                    <p class="Code2">Dim key</p>
                    <p class="Code2">Dim myComment</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">key = "0000000034"</p>
                    <p class="Code2">myComment = "Hello, World!"</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">ElsClient.UpdateEventComment key, myComment</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="UpdateUs"></a>UpdateUserFlag</h3>
        <p>The <b>UpdateUserFlag</b> method takes a valid Event Logging Service database key and will set the specific User Flag on the corresponding record.  If setting more than one flag on a given DbKey, using the UpdateUserFlags is more efficient. Set to True to enable, False to disable. Valid Flag values are 1-10</p>
        <h4>Syntax</h4>
        <p class="Syntax">UpdateUserFlag(<i>DbKey</i> As String, <i>Flag</i> As Integer, <i>Setting</i> As Boolean)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>DbKey</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>A valid Level 1 DBKey for the record to update in a string form.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>Flag</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The flag to change.  This is a numeric value of 1 to 10 corresponding to UserFlag01 though UserFlag10.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>Setting</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>A Boolean value of True to set the user flag or False to clear the user flag.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p><i>Return Value:</i>&#160; None.   An error is generated if the Update to the user flag does not succeed.</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example clears the first user flag on DbKey 0000000282 and sets the fifth user flag on DbKey 0000000283.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Dim ElsClient</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'Create the Els Client Object</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">ElsClient = CreateObject("CxEls.ElsClient" )</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'Connect to the appropriate ELS</p>
                    <p class="Code">ElsClient.Connect "MYSITE.ELS"</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'Clear UserFlag01 on DbKey 0000000282</p>
                    <p class="Code">m_ElsClient.UpdateUserFlag( "0000000282", 1, False)</p>
                    <p class="Code">...</p>
                    <p class="Code">...</p>
                    <p class="Code">'Set UserFlag05 0000000283</p>
                    <p class="Code">m_ElsClient.UpdateUserFlag( "0000000283", 1, True)</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="UpdateUserFlags"></a>UpdateUserFlags</h3>
        <p>The <b>UpdateUserFlags</b> method takes a valid Event Logging Service database key and will set the specific User Flag on the corresponding record.  If setting more than one flag on a given DbKey, using the UpdateUserFlags is more efficient. True means set the flag, False means clear the flag, Empty or Null means leave existing value. </p>
        <h4>Syntax</h4>
        <p class="Syntax">UpdateUserFlags(<i>DbKey</i> As String, <i>ArrFlags</i>)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>DbKey</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>A valid Level 1 DBKey for the record to update in a string form.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>arrFlags</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>An array of the flags to change.  Each Entry in the array maybe represents a single flag.  The value of each entry is True to set the flag, False to clear the Flag or Empty or Null to retain the current value of the flag.  The array index is zero based, so index 0 is UserFlag01 and index 9 is UserFlag10.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p><i>Return Value:</i>&#160; None.   An error is generated if the Update to the user flags does not succeed.</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example clears UserFlag01 and sets UserFlag05 on DbKey 0000000282. Then, it clears all the flags on DbKey 0000000283 except for UserFlag07.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Dim ElsClient</p>
                    <p class="Code">Dim arrFlags</p>
                    <p class="Code">Dim iIndex</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'Create the Els Client Object</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">ElsClient = CreateObject("CxEls.ElsClient" )</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'Connect to the appropriate ELS</p>
                    <p class="Code">ElsClient.Connect "MYSITE.ELS"</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'allocate the array, Redim is the upperbound based so subtract 1</p>
                    <p class="Code">'from the number of flags.</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">Redim arrFlags(ElsClient.UserFlagCount - 1)</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'Clear UserFlag01, set UserFlag05, and leave all the rest alone</p>
                    <p class="Code">arrFlags(0) = False</p>
                    <p class="Code">arrFlags(4) = True</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'Update the flags on dbkey 0000000282</p>
                    <p class="Code">m_ElsClient.UpdateUserFlags( "0000000282, arrFlags)</p>
                    <p class="Code">...</p>
                    <p class="Code">...</p>
                    <p class="Code">'Now Clear all the flags on 0000000283 except UserFlag07</p>
                    <p class="Code">'Clear all the flags</p>
                    <p class="Code">For iIndex = LBound(arrFlags) to UBound(arrFlags )</p>
                    <p class="Code">arrFlags(iIndex) = False</p>
                    <p class="Code">Next</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'Retain the value for UserFlag07</p>
                    <p class="Code">arrFlags(6) = Empty</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'Now update the flags</p>
                    <p class="Code">m_ElsClient.UpdateUserFlag( "0000000283", arrFlags)</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <hr width="100%" size="1" />
        <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/NoBorder8.css');" summary="MasterFooter" class="TableStyle-NoBorder8" cellspacing="0">
            <col class="TableStyle-NoBorder8-Column-Column1" />
            <col class="TableStyle-NoBorder8-Column-Column1" />
            <tbody>
                <tr class="TableStyle-NoBorder8-Body-Body1">
                    <td class="TableStyle-NoBorder8-BodyB-Column1-Body1">
                        <p><a href="mailto:softwaredocs.feedback@weatherford.com?subject=Documentation%20feedback"><img src="../../Resources/Images/Shared Images/Feedback_footer.png" alt="Let us know how we can improve this topic." title="Let us know how we can improve this topic." class="Inline" /></a>
                        </p>
                    </td>
                    <td class="TableStyle-NoBorder8-BodyA-Column1-Body1">
                        <p class="MasterFooterContact"><a href="https://www.weatherford.com/en/products-and-services/production/production-4-0/iot-scada-platform//" target="_blank"><img src="../../Resources/Images/Shared Images/WFT_31x21.png" alt="CygNet at weatherford.com" title="CygNet at weatherford.com" /></a>
                        </p>
                        <p class="MasterFooterContact">© <span class="CygNetVariablesCurrentYear">2020</span> Weatherford. All rights reserved.</p>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>