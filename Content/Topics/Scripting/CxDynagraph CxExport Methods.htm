<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en" xml:lang="en" data-mc-search-type="Stem" data-mc-help-system-file-name="CygNet.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Scripting|CxDynagraph|CxExport Object">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>CxExport Methods</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/HelpTable2.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/NoBorder8.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/HTML5.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><a class="MCBreadcrumbsLink" href="CygNet Scripting.htm">Scripting</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="CxDynagraph.htm">CxDynagraph</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="CxDynagraph CxExport Object.htm">CxExport Object</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">CxExport Methods</span>
        </div>
        <h2>CxExport Methods</h2>
        <p>The following methods are available for interfacing with the <b>CxDynagraph.CxExport</b> object:</p>
        <ul>
            <li class="HyperlinkList" value="1"><a href="#CancelEx" class="selected">CancelExport</a>
            </li>
            <li class="HyperlinkList" value="2"><a href="#GetStatu" class="selected">GetStatus</a>
            </li>
            <li class="HyperlinkList" value="3"><a href="#IsExport" class="selected">IsExportRunning</a>
            </li>
            <li class="HyperlinkList" value="4"><a href="#StartExp" class="selected">StartExport</a>
            </li>
        </ul>
        <p>For information about other methods not specific to CxDynagraph.CxExport, including additional export methods, see <a href="CxDynagraph CxDynagraph Methods.htm">CxDynagraph Methods</a>.</p>
        <h3><a name="CancelEx"></a>CancelExport</h3>
        <p>The <b>CancelExport</b> method enables you to define how many seconds to wait before canceling the export.</p>
        <h4>Syntax</h4>
        <p class="Syntax">CancelExport(<i>iSecondsToWait</i> As Long) As Boolean</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">iSecondsToWait</td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">Yes</td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">Defines the maximum number of seconds to wait before canceling the export.</td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetStatu"></a>GetStatus</h3>
        <h4>Syntax</h4>
        <p class="Syntax">GetStatus() As String</p><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="IsExport"></a>IsExportRunning</h3>
        <h4>Syntax</h4>
        <p class="Syntax">IsExportRunning() As Boolean</p><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="StartExp"></a>StartExport</h3>
        <p>The <b>StartExport</b> method defines the export of the specified set of dynagraph cards upon a defined event.</p>
        <h4>Syntax</h4>
        <p class="Syntax">StartExport(<i>UisOrDdsSiteService</i> As String, <i>Filter</i> As String, <i>CardTypes</i> As Integer, <i>SurfaceCard</i> As Boolean, <i>DateTime</i> As String, <i>ExportFormat</i> As Integer, <i>FileSpecifier</i> As String, <i>StatusTag</i> As String) As Boolean</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>UisOrDdsSiteService</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The <b>UisOrDdsSiteService</b> method defines the relevant UIS or DDS site and service in "Site.Service" format. For example,  TEST.UIS.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>Filter</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>Identifies a set of devices to export. Only pumpoff control devices can be included.</p>
                    <div class="Note">
                        <p><span class="NoteHeading">Note:</span>Setting a device filter to DEVICE_ENABLED=Y yields a list of all enabled pumpoff control devices. Setting a device filter to DEVICE_TYPE=LUFKINSAM yields a list of all Lufkin SAM devices. Setting a device filter to FACILITY_ID=SAM_TEST yields the one facility with Facility ID SAM_TEST.</p>
                    </div>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>CardTypes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>Identifies a set of card types to export.</p>
                    <p>Cards are identified by the following numeric constants:</p>
                    <ul class="table">
                        <li value="1">Current = 1</li>
                        <li value="2">Shutdown = 2</li>
                        <li value="3">Pump-up = 4</li>
                        <li value="4">Reference = 8</li>
                        <li value="5">Start = 16</li>
                    </ul>
                    <p>To export both shutdown and pump-up cards, set to 6 (shutdown (2) + pumpup (4) = 6).</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>SurfaceCard</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>Indicates if a card is a surface card (true) or a downhole card (false).</p>
                    <p>Currently, the only export format valid for downhole cards is .csv.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>DateTime</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>Represents the earliest card time (DDS transaction timestamp) to export.</p>
                    <p>It can be an absolute time (for instance, 1/14/2019) or relative time (for instance, t-1 = yesterday).</p>
                    <p>If left blank, the single most recently retrieved card is exported. Otherwise, all cards retrieved on or after this time are exported.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>ExportFormat</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>Indicates the export file format.</p>
                    <p>File formats are  identified by the following numeric constants:</p>
                    <ul class="table">
                        <li value="1">.csv = 1</li>
                        <li value="2">Lufkin DIAG = 2</li>
                        <li value="3">Theta = 3</li>
                    </ul>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FileSpecifier</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>Specifies the folder (or file) in which to store the relevant export files.</p>
                    <p>If no file name is specified, the default file name is FacilityId_DateTime.<i>filename</i>, where <i>.filename</i> is the file extension specific to the export format.</p>
                    <p>Keyword substitution is provided for facility ID, date, sequence number, card type, and file extension.</p>
                    <p>For example, a default file name can be represented as "%fac%_%date%.%ext%".</p>
                    <p>A file specifier of "c:\DynaExport\%fac%_%date%\Current%seq%.%ext%" puts the cards for each facility and date into a different folder. For instance, c:\DynaExport\FAC1_2007-09-29\Current0.DAT.</p>
                    <p>The following are all of the format specifiers available:</p>
                    <ul class="table">
                        <li value="1">%fac%				= facility ID</li>
                        <li value="2">%date%			= transaction date time in the format YYYY-MM-DD-HHMMSS.mmm</li>
                        <li value="3">%seq%				= sequence number to distinguish cards</li>
                        <li value="4">%card%			= card type (C=current, S=shutdown, P=pumpup, R=reference, T=start, I=ideal)</li>
                        <li value="5">%ext%				= file extension for selected export format</li>
                    </ul>
                    <p>Additional formatting is available for dates and sequence numbers; the nomenclature is the same as on CygNet Studio screens.</p>
                    <p>For example "%date[yyyy-mmm-dd]%" results in the a date formatted as 2007-Sep-19.</p>
                    <p>Sequence number formatting can be used to zero pad numbers. For example, "%seq[000]%" results in a 3-digit sequence number.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>StatusTag</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>Writes export status to a fully qualified tag. Upon successful export, this value indicates the number of facilities and number of cards exported.</p>
                    <p>Leave blank to omit recording to a status tag.</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3>CxDynagraph.CxExport Example</h3>
        <p>The following is a very simple example used in a CygNet Studio screen.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">On Error Resume Next</p>
                    <p class="Code">Dim gDynaExp</p>
                    <p class="Code">Set gDynaExp = CreateObject("CxDynagraph.CxExport")</p>
                    <p class="Code">If err.number &lt;&gt; 0 Then</p>
                    <p class="Code2">MsgBox "Unable to create object"</p>
                    <p class="Code2">Exit Sub</p>
                    <p class="Code">End If</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">' UisOrDdsSiteService</p>
                    <p class="Code">' Filter</p>
                    <p class="Code">' CardTypes 1=current; 2=shutdown; 4=pumpup; 8=reference; 16=start</p>
                    <p class="Code">' SurfaceCard</p>
                    <p class="Code">' DateTime (blank = most recent card)</p>
                    <p class="Code">' ExportFormat: 1=csv; 2=diag; 3=theta</p>
                    <p class="Code">' FileSpecifier</p>
                    <p class="Code">' StatusTag (blank = none)</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">gDynaExp.StartExport  "SEK.UIS", "DEVICE_ID=SAM45", 1, True, "May 2, 2007 13:34", 2, "d:\CygNet\ExportFiles", "SEK.UIS:SAM45_EXP_STATUS"</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">' wait for thread to complete before exiting;</p>
                    <p class="Code">' because of local object (gDynaExp) declaration in this example</p>
                    <p class="Code">' the dynagraph object is destroyed when the function exits</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">While gDynaExp.IsExportRunning()</p>
                    <p class="Code2">wscript.sleep(100)	' wait in milliseconds</p>
                    <p class="Code">Wend</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">'In an HSS script, call CygNetScriptHost.Sleep(100) instead of wscript.sleep(100). The CygNetScriptHost.Sleep() function returns false if the HSS is in the midst of shutting down.</p>
                    <p class="Code">&#160;</p>
                    <p class="Code">bShutdown = false</p>
                    <p class="Code">While gDynaExp.IsExportRunning() and not bShutdown</p>
                    <p class="Code2">bShutdown = CygNetScriptHost.Sleep(100) ' wait in milliseconds</p>
                    <p class="Code">Wend</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <hr width="100%" size="1" />
        <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/NoBorder8.css');" summary="MasterFooter" class="TableStyle-NoBorder8" cellspacing="0">
            <col class="TableStyle-NoBorder8-Column-Column1" />
            <col class="TableStyle-NoBorder8-Column-Column1" />
            <tbody>
                <tr class="TableStyle-NoBorder8-Body-Body1">
                    <td class="TableStyle-NoBorder8-BodyB-Column1-Body1">
                        <p><a href="mailto:softwaredocs.feedback@weatherford.com?subject=Documentation%20feedback"><img src="../../Resources/Images/Shared Images/Feedback_footer.png" alt="Let us know how we can improve this topic." title="Let us know how we can improve this topic." class="Inline" /></a>
                        </p>
                    </td>
                    <td class="TableStyle-NoBorder8-BodyA-Column1-Body1">
                        <p class="MasterFooterContact"><a href="https://www.weatherford.com/en/products-and-services/production/production-4-0/iot-scada-platform//" target="_blank"><img src="../../Resources/Images/Shared Images/WFT_31x21.png" alt="CygNet at weatherford.com" title="CygNet at weatherford.com" /></a>
                        </p>
                        <p class="MasterFooterContact">© <span class="CygNetVariablesCurrentYear">2020</span> Weatherford. All rights reserved.</p>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>