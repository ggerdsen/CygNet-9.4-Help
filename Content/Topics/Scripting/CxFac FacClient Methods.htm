<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en" xml:lang="en" data-mc-search-type="Stem" data-mc-help-system-file-name="CygNet.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Scripting|CxFac|FacClient Object">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>FacClient Methods</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/NoBorder.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/HelpTable2.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/NoBorder8.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/HTML5.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><a class="MCBreadcrumbsLink" href="CygNet Scripting.htm">Scripting</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="CxFac.htm">CxFac</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="CxFac FacClient Object.htm">FacClient Object</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">FacClient Methods</span>
        </div>
        <h2>FacClient Methods</h2>
        <p>The <b>FacClient</b> object contains the following methods:</p>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/NoBorder.css');" class="TableStyle_NoBorder" cellspacing="0">
            <col />
            <col />
            <tr>
                <td class="TableStyle_NoBorder_Body_0_0_RowSep_ColSep">
                    <ul>
                        <li class="HyperlinkList" value="1"><a href="#AddFacilityRecord" class="selected">AddFacilityRecord</a>
                        </li>
                        <li class="HyperlinkList" value="2"><a href="#Connect" class="selected">Connect</a>
                        </li>
                        <li class="HyperlinkList" value="3"><a href="#DeleteFacilityRecord" class="selected">DeleteFacilityRecord</a>
                        </li>
                        <li class="HyperlinkList" value="4"><a href="#Disconnect" class="selected">Disconnect</a>
                        </li>
                        <li class="HyperlinkList" value="5"><a href="#FinishBulkUpdates" class="selected">FinishBulkUpdates</a>
                        </li>
                        <li class="HyperlinkList" value="6"><a href="#GetActiveServices" class="selected">GetActiveServices</a>
                        </li>
                        <li class="HyperlinkList" value="7"><a href="#GetConsoleData" class="selected">GetConsoleData</a>
                        </li>
                        <li class="HyperlinkList" value="8"><a href="#GetCvsOnlyFacilities" class="selected">GetCvsOnlyFacilities</a>
                        </li>
                        <li class="HyperlinkList" value="9"><a href="#GetCvsServiceList" class="selected">GetCvsServiceList</a>
                        </li>
                        <li class="HyperlinkList" value="10"><a href="#GetDeviceCatSpecificFacilities" class="selected">GetDeviceCatSpecificFacilities</a>
                        </li>
                        <li class="HyperlinkList" value="11"><a href="#GetEmptyRecordXml" class="selected">GetEmptyRecordXml</a>
                        </li>
                        <li class="HyperlinkList" value="12"><a href="#GetFacilitiesByFacilityType" class="selected">GetFacilitiesByFacilityType</a>
                        </li>
                        <li class="HyperlinkList" value="13"><a href="#GetFacilitiesList" class="selected">GetFacilitiesList</a>
                        </li>
                    </ul>
                </td>
                <td class="TableStyle_NoBorder_Body_0_0_RowSep_ColEnd">
                    <ul>
                        <li class="HyperlinkList" value="1"><a href="#GetFacilityAttributeList" class="selected">GetFacilityAttributeList</a>
                        </li>
                        <li class="HyperlinkList" value="2"><a href="#GetFacilityTypeList" class="selected">GetFacilityTypeList</a>
                        </li>
                        <li class="HyperlinkList" value="3"><a href="#GetRecordXMLAttribute" class="selected">GetRecordXMLAttribute</a>
                        </li>
                        <li class="HyperlinkList" value="4"><a href="#GetReferences" class="selected">GetReferences</a>
                        </li>
                        <li class="HyperlinkList" value="5"><a href="#ReadFacilityRecord" class="selected">ReadFacilityRecord</a>
                        </li>
                        <li class="HyperlinkList" value="6"><a href="#ReadFacilityRecordForUpdate" class="selected">ReadFacilityRecordForUpdate</a>
                        </li>
                        <li class="HyperlinkList" value="7"><a href="#ReadFacilityRecords" class="selected">ReadFacilityRecords</a>
                        </li>
                        <li class="HyperlinkList" value="8"><a href="#ReleaseFacilityRecordLock" class="selected">ReleaseFacilityRecordLock</a>
                        </li>
                        <li class="HyperlinkList" value="9"><a href="#SetRecordXMLAttribute" class="selected">SetRecordXMLAttribute</a>
                        </li>
                        <li class="HyperlinkList" value="10"><a href="#StartBulkUpdates" class="selected">StartBulkUpdates</a>
                        </li>
                        <li class="HyperlinkList" value="11"><a href="#UpdateAttributesForFacilities" class="selected">UpdateAttributesForFacilities</a>
                        </li>
                        <li class="HyperlinkList" value="12"><a href="#UpdateFacilityRecord" class="selected">UpdateFacilityRecord</a>
                        </li>
                    </ul>
                </td>
            </tr>
        </table>
        <h3><a name="AddFacilityRecord"></a>AddFacilityRecord</h3>
        <p>The <b>AddFacilityRecord</b> method adds a new facility from an XML record.</p>
        <h4>Syntax</h4>
        <p class="Syntax">AddFacilityRecord(<i>RecordXML</i> as String)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>RecordXML</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The XML record that contains the attributes that will be stored in the new facility.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>The XML used to create the facility should be in the same format as the XML returned from <a href="#ReadFacilityRecord" class="selected">ReadFacilityRecord</a>, as in the following example.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">&lt;CygNetFacilityRecord lock_user="VSI\" lock_time="-1214347123" facility_attr0="" facility_attr1="" facility_category="REMDEV" facility_desc="CYGDEMO_RTU" facility_id="Cyg_RTU" facility_info0="" facility_info1="" facility_is_active="Y" facility_is_ref_any="Y" ... /&gt;</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p>The following example creates a new facility using an XML record stored in edtXML.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub AddRecord()</p>
                    <p class="Code2">FacClient.AddFacilityRecord edtXML.Text</p>
                    <p class="Code2">MsgBox "Facility Added"</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="Connect"></a>Connect</h3>
        <p>The <b>Connect</b> method connects the object to a service.</p>
        <h4>Syntax</h4>
        <p class="Syntax">Connect(<i>DomainSiteService</i> As String)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 171px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 100px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>DomainSiteService</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The <i>[Domain]Site.Service</i> to which to connect.&#160; A domain is optional. The service must be a valid FAC.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>Returns 0 if successful and a non-zero value if the connection failed.</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example connects the FacClient object to the CYGDEMO.FAC on domain 5410:</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub FacConnect()</p>
                    <p class="Code2">'Connect to a FAC</p>
                    <p class="Code2">Dim FacClient</p>
                    <p class="Code2">Set FacClient = CreateObject("CxFac.FacClient")</p>
                    <p class="Code2">FacClient.Connect("[5410]CYGDEMO.FAC")</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="DeleteFacilityRecord"></a>DeleteFacilityRecord</h3>
        <p>The <b>DeleteFacilityRecord</b> method deletes a facility.</p>
        <h4>Syntax</h4>
        <p class="Syntax">DeleteFacilityRecord(<i>FacTag</i> as String) As Boolean</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FacTag</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The facility to delete.</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p>The following example deletes a facility and notifies the user if an error occurs.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub DeleteFacRecord()</p>
                    <p class="Code2">Dim Success</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">Success = FacClient.DeleteFacilityRecord ("CYGDEMO.UIS::CYG_METER")</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">If Success = True Then</p>
                    <p class="Code3">MsgBox "Facility deleted"</p>
                    <p class="Code2">Else</p>
                    <p class="Code3">MsgBox "Error in deleting"</p>
                    <p class="Code2">End IF</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="Disconnect"></a>Disconnect</h3>
        <p>The <b>Disconnect</b> method disconnects from the service.</p>
        <h4>Syntax</h4>
        <p class="Syntax">Disconnect() As Short</p>
        <p class="Example">Example</p>
        <p>The following example disconnects from the connected FAC service.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub FacDisconnect()</p>
                    <p class="Code2">FacClient.Disconnect()</p>
                    <p class="Code2">MsgBox "Disconnected from FAC"</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="FinishBulkUpdates"></a>FinishBulkUpdates</h3>
        <p>The <b>FinishBulkUpdates</b> method disables bulk updating.</p>
        <h4>Syntax</h4>
        <p class="Syntax">FinishBulkUpdates()</p>
        <h4>Remarks</h4>
        <p>This method disables bulk updating and makes the FAC flush changes to the disk after every point is updated.</p>
        <p class="Example">Example</p>
        <p>The following example stops bulk updating and restores normal updating.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub StopBulkUpdates()</p>
                    <p class="Code2">FacClient.FinishBulkUpdates</p>
                    <p class="Code2">MsgBox "Bulk Updating disabled"</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetActiveServices"></a>GetActiveServices</h3>
        <p>The <b>GetActiveServices</b> method returns a list of active FAC services. </p>
        <h4>Syntax</h4>
        <p class="Syntax">GetActiveServices(<i>ServiceList</i> as Array)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>ServiceList</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The list of IDs of active facilities returned by this method.</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p>The following example retrieves a list of active FAC services and stores them in a list box.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub GetActiveServices()</p>
                    <p class="Code2">Dim activeServices</p>
                    <p class="Code2">Dim fac</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">FacClient.GetActiveServices activeServices</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">For Each fac In activeServices</p>
                    <p class="Code3">lboFac.AddString(fac)</p>
                    <p class="Code2">Next</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetConsoleData"></a>GetConsoleData</h3>
        <p>The <b>GetConsoleData</b> method returns the console text and display attributes as two 25x80 arrays of unsigned characters. </p>
        <h4>Syntax</h4>
        <p class="Syntax">GetConsoleData(ByRef <i>pText</i>, ByRef <i>pAttr</i>) As Integer</p>
        <h4>Parameters</h4>
        <table style="mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;margin-left: 0;margin-right: auto;caption-side: top;" class="TableStyle-HelpTable2" cellspacing="0">
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>pText</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>A two-dimensional 25x80 array of console text attributes returned by this method.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>pAttr</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>A two-dimensional 25x80 array of console display attributes returned by this method.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>This method returns 0 if successful.</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example writes the console text and display attributes to a CSV file.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub</p>
                    <p class="Code2">Dim aryText, aryAttr, nRet</p>
                    <p class="Code2">nRet = FacClient.GetConsoleData(aryText, aryAttr)</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">' Write text attributes to CSV file</p>
                    <p class="Code2">Dim i, j, strMsg</p>
                    <p class="Code3">For i = 0 To UBound(aryText, 1)</p>
                    <p class="Code3">For j = 0 To UBound(aryText, 2)</p>
                    <p class="Code4">strMsg = strMsg + CStr(aryText(i, j)) + ","</p>
                    <p class="Code3">Next</p>
                    <p class="Code4">strMsg = strMsg + vbCr</p>
                    <p class="Code2">Next</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">dim fso, file</p>
                    <p class="Code2">Set fso = CreateObject("Scripting.FileSystemObject")</p>
                    <p class="Code2">Set file = fso.OpenTextFile("c:\console_text_attrs.csv", 2, True)</p>
                    <p class="Code2">file.WriteLine(strMsg)</p>
                    <p class="Code2">file.Close </p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">strMsg = ""</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">' Write display attributes to CSV file</p>
                    <p class="Code3">For i = 0 To UBound(aryAttr, 1)</p>
                    <p class="Code3">For j = 0 To UBound(aryAttr, 2)</p>
                    <p class="Code4">strMsg = strMsg + CStr(aryAttr(i, j)) + ","</p>
                    <p class="Code3">Next</p>
                    <p class="Code4">strMsg = strMsg + vbCr</p>
                    <p class="Code2">Next</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">Set file = fso.OpenTextFile("c:\console_disp_attrs.csv", 2, True)</p>
                    <p class="Code2">file.WriteLine(strMsg)</p>
                    <p class="Code2">file.Close </p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">MsgBox nRet</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetCvsOnlyFacilities"></a>GetCvsOnlyFacilities</h3>
        <p>The <b>GetCvsOnlyFacilities</b> method returns a list of current value service facilities.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetCvsOnlyFacilites(<i>SiteService</i> as String, <i>FacilityList</i> as Array)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>SiteService</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The <i>Site.Service</i> to which the facilities are connected. This parameter must specify a current value service.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>FacilityList</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The list of facilities returned by this method.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>The returned list will not include facilities associated with the DDS, such as remote device or communication device facilities.</p>
        <p class="Example">Example</p>
        <p>The following example retrieves all facilities associated with CYGDEMO.UIS and displays them in a list box.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub GetCvsFacs()</p>
                    <p class="Code2">Dim CvsList</p>
                    <p class="Code2">Dim fac</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">FacClient.GetCvsOnlyFacilities "CYGDEMO.UIS", CvsList</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">For Each fac In CvsList</p>
                    <p class="Code3">lboFac.AddString(fac)</p>
                    <p class="Code2">Next</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetCvsServiceList"></a>GetCvsServiceList</h3>
        <p>The <b>GetCvsServiceList</b> method returns the service names of all current value services referenced by facility records.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetCvsServiceList(<i>ServiceList</i> as Array)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>ServiceList</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The list of current value services returned by this method.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>The returned service names will be in <i>Site.Service</i> format.</p>
        <p class="Example">Example</p>
        <p>The following example gets all the current value services that the facilities are associated with and stores them in a list box.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub GetCvsServices()</p>
                    <p class="Code2">Dim CvsList</p>
                    <p class="Code2">Dim cvs</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">'Get a list of CVSes associated with the PNT service</p>
                    <p class="Code2">FacClient.GetCvsServiceList CvsList</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">'Store each CVS in a list box</p>
                    <p class="Code2">For Each cvs In CvsList</p>
                    <p class="Code3">lboCvs.AddString(cvs)</p>
                    <p class="Code2">Next</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetDeviceCatSpecificFacilities"></a>GetDeviceCatSpecificFacilities</h3>
        <p>The <b>GetDeviceCatSpecificFacilities</b> method returns the list of facilities with a specified device category type.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetDeviceCatSpecificFacilities(<i>SiteService</i> as String, <i>DeviceCategory</i> as String, <i>FacilityList</i> as Array)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>SiteService</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The <i>Site.Service</i> with which the facilities are associated. This parameter must specify a current value service.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>DeviceCategory</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The device category of the device. Valid device category options are: </p>
                    <ul class="table">
                        <li value="1">RD - Remote devices</li>
                        <li value="2">CD - Comm devices</li>
                        <li value="3">ED - Import/Export devices</li>
                        <li value="4">TD - Template devices</li>
                        <li value="5">FD - FacRoot devices</li>
                    </ul>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FacilityList</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The list of facilities returned by this method.</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p>The following example retrieves all facilities with a device category of RD, and displays them in a list box.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub GetDeviceCatFacs()</p>
                    <p class="Code2">Dim FacList</p>
                    <p class="Code2">Dim fac</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">FacClient.GetDeviceCatSpecificFacilities "CYGDEMO.UIS", "RD", FacList</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">For Each fac In FacList</p>
                    <p class="Code3">lboFac.AddString(fac)</p>
                    <p class="Code2">Next</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetEmptyRecordXml"></a>GetEmptyRecordXml</h3>
        <p>The <b>GetEmptyRecordXml</b> method returns an empty facility record XML.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetEmptyRecordXml() As String</p>
        <h4>Remarks</h4>
        <p>This method can be used in the process of creating a new facility. After the empty record XML is retrieved, use the <a href="#SetRecordXMLAttribute" class="selected">SetRecordXMLAttribute</a> method to set the new facilty record attribute values. Then use the <a href="#AddFacilityRecord" class="selected">AddFacilityRecord</a> method to add the new facility from the XML string created by the <a href="#SetRecordXMLAttribute" class="selected">SetRecordXMLAttribute</a> method.</p>
        <p>The string is returned as XML. The following is an example of what this method will return.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">&lt;CygNetFacilityRecord /&gt;</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p>The following example gets the XML for an empty facility and saves it to an XML document.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub GetEmptyRecord()</p>
                    <p class="Code2">'Get facility xml</p>
                    <p class="Code2">Dim strInfo</p>
                    <p class="Code2">strInfo = FacClient.GetEmptyRecordXml</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">'Save XML</p>
                    <p class="Code2">Set xmlDoc = CreateObject("Msxml2.DOMDocument")</p>
                    <p class="Code2">xmlDoc.loadXML(strInfo)</p>
                    <p class="Code2">xmlDoc.save("C:\EmptyFacility.xml")</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetFacilitiesByFacilityType"></a>GetFacilitiesByFacilityType</h3>
        <p>The <b>GetFacilitiesByFacilityType</b> method returns the list of facilities of a specified facility type.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetFacilitiesByFacilityType(<i>FacilityType</i> as String, <i>SiteService</i> as String, <i>FacilityList</i> as Array)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FacilityType</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The facility type of the facilities to be retrieved.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>SiteService</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The <i>Site.Service</i> of the current value service with which the facilities are associated.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FacilityList</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The list of facilities returned by this method.</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p>The following example retrieves all facilities with a facility type of "REMDEV" and displays them in a list box.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub GetByFacilityType()</p>
                    <p class="Code2">Dim FacList</p>
                    <p class="Code2">Dim fac</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">FacClient.GetFacilitiesByFacilityType "REMDEV", "CYGDEMO.UIS", FacList</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">For Each fac In FacList</p>
                    <p class="Code3">lboFac.AddString(fac)</p>
                    <p class="Code2">Next</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetFacilitiesList"></a>GetFacilitiesList</h3>
        <p>The <b>GetFacilitiesList</b> method returns the list of the facilities associated with a given <i>Site.Service</i>.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetFacilitiesList(<i>SiteService</i> as String, <i>FacilityList</i> as Array)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>SiteService</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The <i>Site.Service</i> of the current value service with which the facilities are associated.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>FacilityList</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The list of facilities returned by this method.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>The returned list of facilities will be stored and sorted in alphabetical order by facility tag.</p>
        <p class="Example">Example</p>
        <p>The following example retrieves all facilities associated with CYGDEMO.UIS and displays them in a list box.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub GetFacilitiesList()</p>
                    <p class="Code2">Dim FacList</p>
                    <p class="Code2">Dim facility</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">FacClient.GetFacilitiesList "CYGDEMO.UIS", FacList</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">For Each facility In FacList</p>
                    <p class="Code3">lboFac.AddString(fac)</p>
                    <p class="Code2">Next</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetFacilityAttributeList"></a>GetFacilityAttributeList</h3>
        <p>The <b>GetFacilityAttributeList</b> method returns the list of attribute names that can be stored in a facility.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetFacilityAttributeList(<i>FacilityList</i> as Array)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FacilityList</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>Output. The returned two-dimensional array of service definitions. The array order is defined as follows:</p>
                    <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/NoBorder.css');" class="TableStyle_NoBorder" cellspacing="0">
                        <col />
                        <col />
                        <tr>
                            <td class="TableStyle_NoBorder_Body_0_0_RowSep_ColSep">
                                <p>0</p>
                            </td>
                            <td class="TableStyle_NoBorder_Body_0_0_RowSep_ColEnd">
                                <p>Internal field number. Do not use.</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_NoBorder_Body_0_0_RowSep_ColSep">
                                <p>1</p>
                            </td>
                            <td class="TableStyle_NoBorder_Body_0_0_RowSep_ColEnd">
                                <p>Short name used by <a href="#SetRecordXMLAttribute" class="selected">SetRecordXMLAttribute</a>.</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_NoBorder_Body_0_0_RowSep_ColSep">
                                <p>2</p>
                            </td>
                            <td class="TableStyle_NoBorder_Body_0_0_RowSep_ColEnd">
                                <p>Attribute Description as displayed in the <b>Configure Attributes</b> dialog box in the Facility service.</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_NoBorder_Body_0_0_RowSep_ColSep">
                                <p>3</p>
                            </td>
                            <td class="TableStyle_NoBorder_Body_0_0_RowSep_ColEnd">
                                <p>Category as displayed in the <b>Configure Attributes</b> dialog box in the Facility service.</p>
                            </td>
                        </tr>
                        <tr>
                            <td class="TableStyle_NoBorder_Body_0_0_RowSep_ColSep">
                                <p>4</p>
                            </td>
                            <td class="TableStyle_NoBorder_Body_0_0_RowSep_ColEnd">
                                <p>True of False depending on whether or not the In Use flag is set in the <b>Configure Attributes</b> dialog box in the Facility service. </p>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p>The following example retrieves a list of attribute names and displays them in a list box.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub GetFacAttributes()</p>
                    <p class="Code2">Dim FacList</p>
                    <p class="Code2">Dim fac</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">FacClient.GetFacilityAttributeList FacList</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">For Each fac In FacList</p>
                    <p class="Code3">lboFac.AddString(fac)</p>
                    <p class="Code2">Next</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetFacilityTypeList"></a>GetFacilityTypeList</h3>
        <p>The <b>GetFacilityTypeList</b> method returns the list of facility types for the given FAC service.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetFacilityTypeList(<i>SiteService</i> as String, <i>FacilityTypeList</i> As Variant)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>SiteService</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The <i>Site.Service</i> for which to retrieve a list of facility types.&#160; If this parameter is an empty string, all facility types will be returned.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>FacilityTypeList</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The list of facility types returned by this method.</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p>The following example displays the list of all facility types.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub</p>
                    <p class="Code2">Dim aryFacTypes</p>
                    <p class="Code2">FacClient.GetFacilityTypeList "", aryFacTypes</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">Dim i, strMsg</p>
                    <p class="Code2">For i = 0 To UBound(aryFacTypes)</p>
                    <p class="Code2">strMsg = strMsg + aryFacTypes(i) + vbCr</p>
                    <p class="Code2">Next</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">MsgBox strMsg</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetRecordXMLAttribute"></a>GetRecordXMLAttribute</h3>
        <p>The <b>GetRecordXMLAttribute</b> method returns the value of an attribute from a facility record. </p>
        <h4>Syntax</h4>
        <p class="Syntax">GetRecordXMLAttribute(<i>RecordXML</i> as String, <i>RecordAttribute</i> as String) As String</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>RecordXML</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The XML record from which to retrieve the attibute value.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>RecordAttribute</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The name of the attribute for which to retrieve a value.&#160; If this attribute is not present in RecordXML, this method will return an empty string.</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p>The following example gets the value for the attribute facility_id and displays it in a message box.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub GetRecordAttribute()</p>
                    <p class="Code2">edtMessageBox.Test = FacClient.GetRecordXMLAttribute( _</p>
                    <p class="Code3">edtXML.Text, "facility_id")</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetReferences"></a>GetReferences</h3>
        <p>The <b>GetReferences</b> method refreshes the list of services referenced by the connected service.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetReferences() As Short</p>
        <p class="Example">Example</p>
        <p>The following example refreshes the list of referenced services.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub GetReferences()</p>
                    <p class="Code2">FacClient.GetReferences()</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="ReadFacilityRecord"></a>ReadFacilityRecord</h3>
        <p>The <b>ReadFacilityRecord</b> method returns the XML record for a facility.</p>
        <h4>Syntax</h4>
        <p class="Syntax">ReadFacilityRecord(<i>FacTag</i> as String) As String</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FacTag</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The tag of the facility for which to retrieve a record.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>The record will be returned in XML format. The following is an example of an excerpt of the returned XML.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">&lt;CygNetFacilityRecord lock_user="VSI\" lock_time="-1214347123" facility_attr0="" facility_attr1="" facility_category="REMDEV" facility_desc="CYGDEMO_RTU" facility_id="Cyg_RTU" facility_info0="" facility_info1="" facility_is_active="Y" facility_is_ref_any="Y" ... /&gt;</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p>The following example retrieves a facility record and saves it to an XML file.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub ReadFacRecord()</p>
                    <p class="Code2">'Get facility xml</p>
                    <p class="Code2">Dim Record</p>
                    <p class="Code2">Record = FacClient.ReadFacilityRecord("CYGDEMO.UIS::Cyg_RTU")</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">'Save XML</p>
                    <p class="Code2">Set xmlDoc = CreateObject("Msxml2.DOMDocument")</p>
                    <p class="Code2">xmlDoc.loadXML(Record)</p>
                    <p class="Code2">xmlDoc.save("C:\FacilityRecord.xml")</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="ReadFacilityRecordForUpdate"></a>ReadFacilityRecordForUpdate</h3>
        <p>The <b>ReadFacilityRecordForUpdate</b> method returns a facility record and locks the facility for updates.</p>
        <h4>Syntax</h4>
        <p class="Syntax">ReadFacilityRecordForUpdate(<i>FacTag</i> as String) As String</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FacTag</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The tag of the facility to read for updates.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>The ReadFacilityRecordForUpdate method returns a record for the given facility and locks the record for update. When the record is locked for update, other users are prevented from editing it until the lock is released or times out. Follow this method by a call to <a href="#UpdateFacilityRecord" class="selected">UpdateFacilityRecord</a> or <a href="#ReleaseFacilityRecordLock" class="selected">ReleaseFacilityRecordLock</a>.</p>
        <p class="Example">Example</p>
        <p>The following example displays a facility record in edtXML and locks the facility for updates.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub ReadFacRecordForUpdate()</p>
                    <p class="Code2">edtXML.Text = FacClient.ReadFacilityRecordForUpdate(Tag)</p>
                    <p class="Code2">MsgBox "Facility locked"</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="ReadFacilityRecords"></a>ReadFacilityRecords</h3>
        <p>The <b>ReadFacilityRecords</b> method returns an XML string containing records for each of the given facility tags.</p>
        <h4>Syntax</h4>
        <p class="Syntax">ReadFacilityRecords(<i>ArrFacTags</i> as Variant) As String</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>ArrFacTags</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>A list of facility tags for which to retrieve records.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>The records will be returned in XML format. The following is an example of an excerpt of the returned XML.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">&lt;CygNetFacilityRecords&gt;</p>
                    <p class="Code">&lt;CygNetFacilityRecord lock_user="FAC" lock_time="-1298593501" facility_attr0="" </p>
                    <p class="Code2">facility_attr1="" facility_attr10="" facility_attr11="" </p>
                    <p class="Code2">facility_attr12="" facility_attr13="" facility_attr14="" </p>
                    <p class="Code2">facility_attr15="" facility_attr16="" facility_attr17="" .../&gt;</p>
                    <p class="Code">...</p>
                    <p class="Code">&lt;/CygNetFacilityRecords&gt;</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p>The following example writes facility records to an XML file.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub</p>
                    <p class="Code2">Dim aryFacTags</p>
                    <p class="Code2">ReDim aryFacTags(2)</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">aryFacTags(0) = "CYGDEMO.UIS::20090303"</p>
                    <p class="Code2">aryFacTags(1) = "CYGDEMO.UIS::FLOWAUTOAP15"</p>
                    <p class="Code2">aryFacTags(2) = "CYGDEMO.UIS::FLOWAUTOAP15A"</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">Dim strXml</p>
                    <p class="Code2">strXml = FacClient.ReadFacilityRecords(aryFacTags)</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">'Save XML</p>
                    <p class="Code2">Dim xmlDoc</p>
                    <p class="Code2">Set xmlDoc = CreateObject("Msxml2.DOMDocument")</p>
                    <p class="Code2">xmlDoc.loadXML(strXml)</p>
                    <p class="Code">xmlDoc.save("C:\FacilityRecords.xml")</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="ReleaseFacilityRecordLock"></a>ReleaseFacilityRecordLock</h3>
        <p>The <b>ReleaseFacilityRecordLock</b> method unlocks a facility record to allow editing.</p>
        <h4>Syntax</h4>
        <p class="Syntax">ReleaseFacilityRecordLock(<i>FacTag</i> as String, <i>RecordXML</i> as String)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FacTag</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The tag of the facility to unlock.  Use the format SITE.SERVICE::FACILITYID</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>RecordXML</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The XML record of the facility to unlock. Generated by <a href="#ReadFacilityRecord" class="selected">ReadFacilityRecord</a>.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>This method releases the lock on the facility record created by the <a href="#ReadFacilityRecordForUpdate" class="selected">ReadFacilityRecordForUpdate</a> method. Once the lock on the record is released, it can then be edited by other users.</p>
        <p class="Example">Example</p>
        <p>The following example unlocks the CYGDEMO_RTU facility record.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub ReleaseFacLock()</p>
                    <p class="Code2">FacClient.ReleaseFacilityRecordLock Tag, XML</p>
                    <p class="Code2">MsgBox "Facility unlocked"</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="SetRecordXMLAttribute"></a>SetRecordXMLAttribute</h3>
        <p>The <b>SetRecordXMLAttribute</b> method sets an attribute value of a specified facility record.</p>
        <h4>Syntax</h4>
        <p class="Syntax">SetRecordXMLAttribute(<i>RecordXML</i> as String, <i>RecordAttribute</i> as String, <i>AttributeValue</i> as String) As String</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>RecordXML</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The facility record XML for which to set an attribute. Generated by <a href="#ReadFacilityRecord" class="selected">ReadFacilityRecord</a>.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>RecordAttribute</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The attribute for which to set a value.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>AttributeValue</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The new value of the attribute.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>This method creates a new XML string containing updated facility attribute values to be used by either the <a href="#UpdateFacilityRecord" class="selected">UpdateFacilityRecords</a> method for a single facility record or the <a href="#UpdateAttributesForFacilities" class="selected">UpdateAttributesForFacilities</a> method for updating multiple facility records.</p>
        <p>SetRecordXmlAttribute sets the attribute name to lowercase before modifying the XML.</p>
        <p class="Example">Example</p>
        <p>The following example creates a new XML string with the new facility record attribute value, but doesn’t update the facility itself.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub SetRecordAtt()</p>
                    <p class="Code2">Dim newPoint</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">newPoint = FacClient.SetRecordXMLAttribute (XML, "facility_category" _</p>
                    <p class="Code2">&#160;&#160;&#160; "REMDEV")</p>
                    <p class="Code2">edtMessageBox.Text = newPoint</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="StartBulkUpdates"></a>StartBulkUpdates</h3>
        <p>The <b>StartBulkUpdates</b> method enables faster updating.</p>
        <h4>Syntax</h4>
        <p class="Syntax">StartBulkUpdates()</p>
        <h4>Remarks</h4>
        <p>Normally, the FAC service will flush the changes to the disk after each facility is updated. If Bulk Updating is enabled, it will only flush every thirty seconds. This decreases the update time but increases the likelihood that data will be lost if a bad shutdown occurs. CygNet recommends that this feature only be turned on while bulk updating occurs and then turned off when finished, using <a href="#FinishBulkUpdates" class="selected">FinishBulkUpdates</a>.</p>
        <p class="Example">Example</p>
        <p>The following example enables Bulk Updating.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub StartBulkUpdates()</p>
                    <p class="Code2">FacClient.StartBulkUpdates()</p>
                    <p class="Code2">MsgBox "FAC Client has started bulk updating"</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="UpdateAttributesForFacilities"></a>UpdateAttributesForFacilities</h3>
        <p>The <b>UpdateAttributesForFacilities</b> method updates multiple facility records with new attribute values from an XML string.</p>
        <h4>Syntax</h4>
        <p class="Syntax">UpdateAttributeForFacilities(<i>FacTags</i> as Array, <i>RecordXML</i> as String, <i>errors</i> as Array) As Integer</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FacTags</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The array of tags of facilities to be updated</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>RecordXML</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The XML string that contains the new facility attribute values.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>errors</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>A list of errors returned by this method.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>This method updates multiple facility records using the XML string returned by the <a href="#SetRecordXMLAttribute" class="selected">SetRecordXMLAttribute</a> method.</p>
        <p>For the RecordXML used in this method, do not include an entire facility record since the method updates multiple facility records. The update would fail as a result of trying to create multiple instances of an identical facility record. The XML string should only contain the attributes that you want to be set the same on all the facilities that are to be updated. The attributes that are not included in the XML string will not be updated when the method is called. </p>
        <p>For example, if the following is stored in RecordXML, only <b>Facility Attribute 0</b> will be updated:</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">&lt;CygNetFacilityRecord facility_attr0="Bill" /&gt;</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p>The following example updates an array of facilities with the attributes from edtXML, and outputs a list of errors in lboerrors.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub UpdateAttributes()</p>
                    <p class="Code2">Dim Tags(1)</p>
                    <p class="Code2">Dim errors(1)</p>
                    <p class="Code2">Dim err</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">Tags(0) = "CYGDEMO.UIS::CYG_RTU"</p>
                    <p class="Code2">Tags(1) = "CYGDEMO.UIS::CYG_METER"</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">FacClient.UpdateAttributesForFacilities Tags, edtXML.Text, errors</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">For Each err In errors</p>
                    <p class="Code3">lboerrors.AddString(err)</p>
                    <p class="Code2">Next</p>
                    <p class="Code2">MsgBox "Facilities updated"</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="UpdateFacilityRecord"></a>UpdateFacilityRecord</h3>
        <p>The <b>UpdateFacilityRecord</b> method updates a single facility record from an XML string.</p>
        <h4>Syntax</h4>
        <p class="Syntax">UpdateFacilityRecord(<i>FacTag</i> as String, <i>RecordXML</i> as String)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 150px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col style="width: 50px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FacTag</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The tag of the facility to update.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>RecordXML</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The XML string containing the new facility attribute values.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>This method updates a single facility record using the XML string returned by the <a href="#SetRecordXMLAttribute" class="selected">SetRecordXMLAttribute</a> method.</p>
        <p>RecordXML does not need to contain an entire facility record. If an attribute is left out, it will not be updated when this method is called. For example, if the following is stored in RecordXML, only Facility Attribute 0 will be updated:</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">&lt;CygNetFacilityRecord facility_attr0="Bill" /&gt;</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p>The following example updates a facility record with the modified XML stored in edtXML.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub UpdateFacRecord()</p>
                    <p class="Code2">FacClient.UpdateFacilityRecord Tag, edtXML.Text</p>
                    <p class="Code2">MsgBox "Facility Updated"</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <hr width="100%" size="1" />
        <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/NoBorder8.css');" summary="MasterFooter" class="TableStyle-NoBorder8" cellspacing="0">
            <col class="TableStyle-NoBorder8-Column-Column1" />
            <col class="TableStyle-NoBorder8-Column-Column1" />
            <tbody>
                <tr class="TableStyle-NoBorder8-Body-Body1">
                    <td class="TableStyle-NoBorder8-BodyB-Column1-Body1">
                        <p><a href="mailto:softwaredocs.feedback@weatherford.com?subject=Documentation%20feedback"><img src="../../Resources/Images/Shared Images/Feedback_footer.png" alt="Let us know how we can improve this topic." title="Let us know how we can improve this topic." class="Inline" /></a>
                        </p>
                    </td>
                    <td class="TableStyle-NoBorder8-BodyA-Column1-Body1">
                        <p class="MasterFooterContact"><a href="https://www.weatherford.com/en/products-and-services/production/production-4-0/iot-scada-platform//" target="_blank"><img src="../../Resources/Images/Shared Images/WFT_31x21.png" alt="CygNet at weatherford.com" title="CygNet at weatherford.com" /></a>
                        </p>
                        <p class="MasterFooterContact">© <span class="CygNetVariablesCurrentYear">2020</span> Weatherford. All rights reserved.</p>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>