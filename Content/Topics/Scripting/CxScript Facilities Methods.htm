<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en" xml:lang="en" data-mc-search-type="Stem" data-mc-help-system-file-name="CygNet.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Scripting|CxScript|Facilities Object">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Facilities Methods</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/HelpTable2.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/NoBorder8.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/HTML5.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><a class="MCBreadcrumbsLink" href="CygNet Scripting.htm">Scripting</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="CxScript.htm">CxScript</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="CxScript Facilities Object.htm">Facilities Object</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Facilities Methods</span>
        </div>
        <h2>Facilities Methods</h2>
        <p>The <b>Facilities</b> object contains the following methods:</p>
        <ul>
            <li class="HyperlinkList" value="1"><a href="#AddFacilitiesArray" class="selected">AddFacilitiesArray</a>
            </li>
            <li class="HyperlinkList" value="2"><a href="#AddFacility" class="selected">AddFacility</a>
            </li>
            <li class="HyperlinkList" value="3"><a href="#AddFacilityTagListHint" class="selected">AddFacilityTagListHint</a>
            </li>
            <li class="HyperlinkList" value="4"><a href="#ChooseFacilities" class="selected">ChooseFacilities</a>
            </li>
            <li class="HyperlinkList" value="5"><a href="#EnableUpdate" class="selected">EnableUpdate</a>
            </li>
            <li class="HyperlinkList" value="6"><a href="#FilterFacilityTagList" class="selected">FilterFacilityTagList</a>
            </li>
            <li class="HyperlinkList" value="7"><a href="#GetFacilityAttribute" class="selected">GetFacilityAttribute</a>
            </li>
            <li class="HyperlinkList" value="8"><a href="#GetFacilityAttributeName" class="selected">GetFacilityAttributeName</a>
            </li>
            <li class="HyperlinkList" value="9"><a href="#GetFacilityTagList" class="selected">GetFacilityTagList</a>
            </li>
            <li class="HyperlinkList" value="10"><a href="#ResolveNow" class="selected">ResolveNow</a>
            </li>
            <li class="HyperlinkList" value="11"><a href="#UpdateNow" class="selected">UpdateNow</a>
            </li>
        </ul>
        <h3><a name="AddFacilitiesArray"></a>AddFacilitiesArray</h3>
        <p>The <b>AddFacilitiesArray</b> method adds the facilities in given array to the cache.</p>
        <h4>Syntax</h4>
        <p class="Syntax">AddFacilitiesArray(<i>ArrTag</i> As Variant)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>ArrTag</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p style="text-align: center;">Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>An array of facility tags to add. They must be in 'Site.Service::FacilityName’ format.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>This method is typically used in a HyperPoint’s <a href="CxScript HyperPoint Events.htm#OnInitializeEx">OnInitializeEx</a>  event, and rarely applies to contexts other than the HSS. When a facility is added to the Facilities object, its attributes are cached, enabling use of the <a href="#GetFacilityAttribute" class="selected">GetFacilityAttribute</a> method.</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example assigns two facilities to the Facilities object to cache.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub addArray()</p>
                    <p class="Code2">Dim arrNames, objFacility</p>
                    <p class="Code2">Set objFacility = CreateObject("CxScript.Facilities")</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">arrNames = Array("CYGDEMO.UIS::BILL305", "CYGDEMO.UIS::LUMBERGH123")</p>
                    <p class="Code2">objFacility.AddFacilitiesArray arrNames</p>
                    <p class="Code2">edtMessageBox.Text = "Facility array added"</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="AddFacility"></a>AddFacility</h3>
        <p>The <b>AddFacility</b> method adds a facility specified by the tag into the cache. </p>
        <h4>Syntax</h4>
        <p class="Syntax">AddFacility(<i>FacilityTag</i> As String)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FacilityTag</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p style="text-align: center;">Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The tag string of the facility to add (in  valid CygNet <a href="../Points/Tag String Formats.htm" class="MCTopicPopup MCTopicPopupHotSpot a">tag string format</a>).</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>This method is typically used in a HyperPoint’s <a href="CxScript HyperPoint Events.htm#OnInitializeEx">OnInitializeEx</a>  event, and rarely applies to contexts other than the HSS. When a facility is added to the Facilities object, its attributes are cached, enabling use of the <a href="#GetFacilityAttribute" class="selected">GetFacilityAttribute</a> method. </p>
        <p class="Example">Example</p>
        <p class="Indent">This example uses the STATUS HyperPoint’s <a href="CxScript HyperPoint Events.htm#OnInitializeEx">OnInitializeEx</a> event to assign two facilities to the Facilities object to cache. </p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub STATUS_OnInitializeEx(This) </p>
                    <p class="Code2">'Add JONES45, METER206, facility tags to the Facilities object</p>
                    <p class="Code2">Facilities.AddFacility "CYGDEMO.UIS::JONES45"</p>
                    <p class="Code2">Facilities.AddFacility "CYGDEMO.UIS::METER206"</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="AddFacilityTagListHint"></a>AddFacilityTagListHint</h3>
        <p>The <b>AddFacilityTagListHint</b> method tells the Facilities object that you will request the given filter with <a href="#GetFacilityTagList" class="selected">GetFacilityTagList</a>. When you call GetFacilityTagList, the Facilities object checks to see if it can resolve the queries requested with AddFacilityTagListHint optimally. If it can, it resolves all those other queries at the same time. This makes subsequent calls to GetFacilityTagList much faster since the query results are already cached. For a large number of queries, this can vastly improve performance. Filter types can be any one of the following:</p>
        <ul>
            <li value="1">Parameterized list of FAC attributes</li>
            <li value="2">FAC rules XML</li>
            <li value="3">FAC expression</li>
        </ul>
        <h4>Syntax</h4>
        <p class="Syntax">AddFacilityTagListHint(<i>FacOrCvsSiteService</i> As String, <i>Filter</i> As String)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FacOrCvsSiteService</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The FAC or CVS site service from which to get the facility tags, in "site.service" format.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>Filter</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The filter criteria. Three types of filter types are allowed. An example of each type of filter is shown below.</p>
                    <ul class="table">
                        <li value="1">Parameterized list — A semicolon-delimited naming filter to select certain facilities, using any of the keywords from the <a href="CxScript Facility Attributes.htm">Facility Attributes</a> list. To retrieve all facility tags, set the Filter parameter to ""</li>
                        <li value="2">FAC rules XML — An XML string representing the facility filter to be used. For a complete list of FAC XML property names, see FAC XML Attributes</li>
                        <li value="3">FAC expression — An arithmetic expression representing the facility filter to be used</li>
                    </ul>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p>See the filter examples in <a href="#GetFacilityTagList" class="selected">GetFacilityTagList</a>. </p>
        <h3><a name="ChooseFacilities"></a>ChooseFacilities</h3>
        <p>The <b>ChooseFilter</b> method displays a <b>Facility Chooser</b> dialog box and returns the selected facilities in an array.</p>
        <h4>Syntax</h4>
        <p class="Syntax">ChooseFacilities(<i>Title</i> As String, <i>SiteService</i> As String, <i>FilterSiteService</i> As String, <i>SelectedFacilities</i> As String, <i>FullFilter</i> As String, <i>EnableServiceFilter</i> As Boolean, <i>EnableServiceChooser</i> As Boolean, <i>MultipleSelect</i> As Boolean, <i>EnableFacEditor</i> As Boolean, <i>DestinationTagList</i> As Variant)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>Title</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The title of the <b>Facility Choose</b> dialog box.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>SiteService</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The site and service to connect to, in "site.service" form. If an empty string is passed, a dialog box will display when the <b>Facility Chooser</b> dialog box does,  to select a FAC service.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FilterSiteService</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>A valid site and service, in "site.service" form. Only facilities connected to this site and service will be displayed. If an empty string is passed, all facilities will show.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>SelectedFacilities</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The facility tags of any facilities to be selected by default when the dialog box is opened, in "site.service::facilityid" form. If an empty string is passed, no facilities will be selected. </p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FullFilter</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>A semicolon-delimited  naming filter to select certain facilities. The filter can include any of the keywords from the <a href="CxScript Facility Attributes.htm">Facility Attributes</a> list.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>EnableServiceFilter</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>Set to True to enable the user to choose which FAC service to view.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>EnableServiceChooser</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>Set to True to enable the user to choose which <i>Site.Service</i> to view.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>MultipleSelect</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>Set to True to enable the user to select more than one facility. This enables/disables the Select All, Deselect All, and Invert buttons.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>EnableFacEditor</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>Set to True to enable the user to edit facilities in the list. This enables/disables the Add Facility and Edit Facility buttons.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>DestinationTagList</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>Output. All of the selected facilities are stored in this array.</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p class="Indent">The following example invokes a <b>Facility Chooser</b> dialog box. It is connected to CYGDEMO.UIS, displays only facilities with a type of meter, and the facility BOBFAC is selected. After the user selects their facilities, they are displayed in a list box. </p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub chooseFac()</p>
                    <p class="Code2">Dim objFacilities</p>
                    <p class="Code2">Set objFacilities = CreateObject("CxScript.Facilities")</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">Dim arrFacList, item</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">'Select facilities</p>
                    <p class="Code2">objFacilities.ChooseFacilities "Choose facilities", "CYGDEMO.UIS", _</p>
                    <p class="Code3">"CYGDEMO.UIS", "CYGDEMO.UIS::BOBFAC", "facility_type=meter", _</p>
                    <p class="Code3">True, True, True, True, arrFacList</p>
                    <p class="Code2">&#160;&#160;&#160;&#160;</p>
                    <p class="Code2">'Display selected facilities in list box</p>
                    <p class="Code2">For Each item In arrFacList</p>
                    <p class="Code3">lstFacilities.AddString(item)</p>
                    <p class="Code2">Next</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="EnableUpdate"></a>EnableUpdate</h3>
        <p>The <b>EnableUpdate</b> method enables or disables auto refreshing of the Facilities object.</p>
        <h4>Syntax</h4>
        <p class="Syntax">EnableUpdate(<i>Enable</i> As Boolean)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>Enable</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p style="text-align: center;">Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>Enables updates if True and disables updates if False.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>By default, the Facilities object is updated when cached facility attributes are changed. If updating is disabled, auto refresh of the Facilities object is prevented. This value is true by default in the HSS. Changing the EnableUpdate property in one HyperPoint script will change it for all scripts (it is a global property). The method is not generally used except in more complex situations.</p>
        <p class="Example">Example</p>
        <p class="Indent">The following example disables updating</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub chooseFac()</p>
                    <p class="Code2">Dim objFacilities</p>
                    <p class="Code2">Set objFacilities = CreateObject("CxScript.Facilities")</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">objFacilities.EnableUpdate(False)</p>
                    <p class="Code2">edtMessageBox.Text = "Updating disabled"</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="FilterFacilityTagList"></a>FilterFacilityTagList</h3>
        <p>The <b>FilterFacilityTagList</b> method filters a source list based on filter criteria and fills a destination list. Filter types can be any one of the following:</p>
        <ul>
            <li value="1">Parameterized list of FAC attributes</li>
            <li value="2">FAC rules XML</li>
            <li value="3">FAC expression</li>
        </ul>
        <h4>Syntax</h4>
        <p class="Syntax">FilterFacilityTagList(<i>SourceTagList</i> As Variant, <i>Filter</i> As String, <i>DestinationTagList</i> As Variant)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>SourceTagList</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>An array of facility tags to be filtered.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>Filter</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The filter criteria. Three types of filter types are allowed. An example of each type of filter is shown below.</p>
                    <ul class="table">
                        <li value="1">Parameterized list — A semicolon-delimited naming filter to select certain facilities, using any of the keywords from the <a href="CxScript Facility Attributes.htm">Facility Attributes</a> list. To retrieve all facility tags, set the Filter parameter to ""</li>
                        <li value="2">FAC rules XML — An XML string representing the facility filter to be used. For a complete list of FAC XML property names, see FAC XML Attributes</li>
                        <li value="3">FAC expression — An arithmetic expression representing the facility filter to be used</li>
                    </ul>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>DestinationTagList</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>Output. The filtered list will be stored in this variable.</p>
                </td>
            </tr>
        </table>
        <p class="Example">Example</p>
        <p class="Indent">See the filter examples in <a href="#GetFacilityTagList" class="selected">GetFacilityTagList</a>. </p>
        <p class="Indent">The following example returns a list of all facilities on a UIS service.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub filterFacTag(arrTagList)</p>
                    <p class="Code2">Dim objFacs</p>
                    <p class="Code2">Set objFacs = CreateObject("CxScript.Facilities")</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">Dim arrNewTags, item</p>
                    <p class="Code2">objFacs.FilterFacilityTagList arrTagList, "FACILITY_SERVICE=UIS", arrNewTags</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">lstFacilities.ResetContent</p>
                    <p class="Code2">For Each item In arrNewTags</p>
                    <p class="Code3">lstFacilities.AddString(item)</p>
                    <p class="Code2">Next</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetFacilityAttribute"></a>GetFacilityAttribute</h3>
        <p>The <b>GetFacilityAttribute</b> method gets the value of an attribute for a specified facility tag.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetFacilityAttribute(<i>FacilityTag</i> As String, <i>FacilityAttribute</i> As String)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FacilityTag</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The tag string of the facility, in valid  CygNet <a href="../Points/Tag String Formats.htm" class="MCTopicPopup MCTopicPopupHotSpot a">tag string format</a>.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>FacilityAttribute</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The name of the attribute. The attribute(s) can include any of the keywords from the <a href="CxScript Facility Attributes.htm">Facility Attributes</a> list.</p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>In the HSS, a facility tag must first be added to the Facilities object using the <a href="#AddFacility" class="selected">AddFacility</a> or <a href="#AddFacilitiesArray" class="selected">AddFacilityArray</a> methods before GetFacilityAttribute can retrieve cached attribute values. When using the Facilities object outside the HSS, attribute value can be retrieved without first adding facilities to the Facilities object.</p>
        <p class="Example">Example</p>
        <p class="Indent">The following method lists several properties for a given facility in a list box. Any or all of the properties can be added to the arrAttrs array.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub ListFacilityAttributes (facName)</p>
                    <p class="Code2">Dim objFacs, arrAttrs, i</p>
                    <p class="Code2">Set objFacs = CreateObject("CxScript.Facilities")</p>
                    <p class="Code2">lstAttributes.ResetContent</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">'Create array of attributes to display</p>
                    <p class="Code2">Redim arrAttrs(2)</p>
                    <p class="Code2">arrAttrs(0) = "FACILITY_ID"</p>
                    <p class="Code2">arrAttrs(1) = "FACILITY_DESC"</p>
                    <p class="Code2">arrAttrs(2) = "FACILITY_TYPE"</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">'List attributes in list box</p>
                    <p class="Code2">For i=lbound(arrAttrs) To ubound(arrAttrs)</p>
                    <p class="Code3">lstAttributes.AddString (arrAttrs(i) &amp; ": " &amp; _</p>
                    <p class="Code4">objFacs.GetFacilityAttribute(facName, arrAttrs(i)))</p>
                    <p class="Code2">Next</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetFacilityAttributeName"></a>GetFacilityAttributeName</h3>
        <p>The <b>GetFacilityAttributeName</b> method returns a facility attribute name given an index.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetFacilityAttributeName(<i>Index</i> As Long)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>Index</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p style="text-align: center;">Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The facility attribute index. </p>
                </td>
            </tr>
        </table>
        <h4>Remarks</h4>
        <p>Facility attribute indexes range from 0 to 57. The returned value is the name of the index. This method is useful for listing names of attributes with their corresponding indexes.</p>
        <p class="Example">Example</p>
        <p class="Indent">The following function lists the names of the first 25 facility attributes in a list box.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub ListAttributes ()</p>
                    <p class="Code2">Dim objFacs, i</p>
                    <p class="Code2">Set objFacs = CreateObject("CxScript.Facilities")</p>
                    <p class="Code2">lstAttributes.ResetContent</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">'List attributes in list box</p>
                    <p class="Code2">For i=0 To 24</p>
                    <p class="Code3">&#160;&#160;&#160;&#160;lstAttributes.AddString objFacs.GetFacilityAttributeName(i)</p>
                    <p class="Code2">Next</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="GetFacilityTagList"></a>GetFacilityTagList</h3>
        <p>The <b>GetFacilityTagList</b> method gets an array of facility tags in a service based on specified filter criteria. Filter types can be any one of the following:</p>
        <ul>
            <li value="1">Parameterized list of FAC attributes</li>
            <li value="2">FAC rules XML</li>
            <li value="3">FAC expression</li>
        </ul>
        <p>Use in conjunction with <a href="#AddFacilityTagListHint" class="selected">AddFacilityTagListHint</a> for performance optimization.</p>
        <h4>Syntax</h4>
        <p class="Syntax">GetFacilityTagList(<i>FacOrCvsSiteService</i> As String, <i>Filter</i> As String, <i>TagList</i> As Variant)</p>
        <h4>Parameters</h4>
        <table style="margin-left: 0;margin-right: auto;caption-side: top;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Parameter</th>
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1" style="text-align: center;">Required</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>FacOrCvsSiteService</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>The FAC or CVS site service from which to get the facility tags, in "site.service" format.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>Filter</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>The filter criteria. Three types of filter types are allowed. An example of each type of filter is shown below.</p>
                    <ul class="table">
                        <li value="1">Parameterized list — A semicolon-delimited naming filter to select certain facilities, using any of the keywords from the <a href="CxScript Facility Attributes.htm">Facility Attributes</a> list. To retrieve all facility tags, set the Filter parameter to ""</li>
                        <li value="2">FAC rules XML — An XML string representing the facility filter to be used. For a complete list of FAC XML property names, see FAC XML Attributes</li>
                        <li value="3">FAC expression — An arithmetic expression representing the facility filter to be used</li>
                    </ul>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>TagList</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1" style="text-align: center;">
                    <p>Yes</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>An array of tags returned.</p>
                </td>
            </tr>
        </table>
        <h4>	Remarks</h4>
        <p>See <a href="CxScript GlobalFunctions Methods.htm#GetFacilityInfo">CxScript.GlobalFunctions.GetFacilityInfo</a> to  return list of FACs using a set of descriptors.</p>
        <p class="Example">Examples</p>
        <p class="Indent">The first three examples show the types of filters that can be used with GetFacilityTagList.</p>
        <p><b>Parameterized List Filter</b>
        </p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">"facility_desc=Station 1;facility_type=Meter Station"</p>
                </td>
            </tr>
        </table>
        <p><b>FAC Rules XML Filter</b>
        </p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">"&lt;ExportedRules exportTime="26/06/2014 13:38:59.267" ruleDataIdentifier="FAC Rules"&gt;</p>
                    <p class="Code2">&lt;Rules enabled="true" inverted="false" op="1" name=""&gt;</p>
                    <p class="Code2">&lt;Rule enabled="true" name="FACDESC" referenceAttr="0" compareToType="0" externalData="" value="Station 1" operator="=" qualifier="Case Sensitive"&gt;&lt;compareItem attr="facility_desc"/&gt;</p>
                    <p class="Code2">&lt;/Rule&gt;</p>
                    <p class="Code2">&lt;Rule enabled="true" name="FACTYPE" referenceAttr="0" compareToType="0" externalData="" value="Meter Station" operator="=" qualifier="Case Sensitive"&gt;&lt;compareItem attr="facility_type"/&gt;</p>
                    <p class="Code2">&lt;/Rule&gt;</p>
                    <p class="Code2">&lt;/Rules&gt;</p>
                    <p class="Code">&lt;/ExportedRules&gt;"</p>
                </td>
            </tr>
        </table>
        <p class="Indent">See <a href="CxEventIF PointFacQuery Methods.htm#SetFacilityFilter">SetFacilityFilter</a> and <a href="CxScript GlobalFunctions Methods.htm#ShowFacilityRulesDialog">ShowFacilityRulesDialog</a> for other FAC Rules XML examples.</p>
        <p><b>FAC Expression Filter</b>
        </p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">"facility_desc = 'Station 1' AND facility_type = 'Meter Station'"</p>
                </td>
            </tr>
        </table>
        <p><b>Code Example</b>
        </p>
        <p class="Indent">The following function lists all facilities of type "DEVICE" on the "UIS" service.</p>
        <table class="Code">
            <tr>
                <td>
                    <p class="Code">Sub ListUISDevices ()</p>
                    <p class="Code2">Dim objFacs, arrTagList, strFilter, i</p>
                    <p class="Code2">Set objFacs = CreateObject("CxScript.Facilities")</p>
                    <p class="Code2">lstFacilities.ResetContent</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">'Get tag list</p>
                    <p class="Code2">strFilter = "FACILITY_TYPE=DEVICE;FACILITY_SERVICE=UIS"</p>
                    <p class="Code2">objFacs.GetFacilityTagList "CYGDEMO.FAC", strFilter, arrTagList</p>
                    <p class="Code2">&#160;</p>
                    <p class="Code2">'List attributes in list box</p>
                    <p class="Code2">For i=lbound(arrTagList) To ubound(arrTagList)</p>
                    <p class="Code3">lstFacilities.AddString(arrTagList(i))</p>
                    <p class="Code2">Next</p>
                    <p class="Code">End Sub</p>
                </td>
            </tr>
        </table><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="ResolveNow"></a>ResolveNow</h3>
        <p>The <b>ResolveNow</b> method immediately gets data for all unresolved facilities in the cache.</p>
        <h4>Syntax</h4>
        <p class="Syntax">ResolveNow()</p>
        <h4>Remarks</h4>
        <p>Whereas the UpdateNow method updates all facilities in a Facilities object, ResolveNow updates just the subset that have not been resolved. This can be used in cases where you suspect that the script engine has not resolved a set a facilities before you need to retrieve their data.</p>
        <p>In non-HSS environments, a EnableUpdate is turned off by default for declared Facilities objects, so updating can be achieved using the UpdateNow or ResolveNow methods rather than enabling updates.</p><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h3><a name="UpdateNow"></a>UpdateNow</h3>
        <p>The <b>UpdateNow</b> method immediately updates all data for all facilities in the cache.</p>
        <h4>Syntax</h4>
        <p class="Syntax">UpdateNow()</p>
        <h4>Remarks</h4>
        <p>This method can be used in cases where you suspect that the script engine has not resolved the majority of points before you need to retrieve their data.</p>
        <p>In non-HSS environments, EnableUpdate is turned off by default for declared Facilities objects, so updating can be achieved using the UpdateNow or ResolveNow methods rather than enabling updates.</p><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <hr width="100%" size="1" />
        <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/NoBorder8.css');" summary="MasterFooter" class="TableStyle-NoBorder8" cellspacing="0">
            <col class="TableStyle-NoBorder8-Column-Column1" />
            <col class="TableStyle-NoBorder8-Column-Column1" />
            <tbody>
                <tr class="TableStyle-NoBorder8-Body-Body1">
                    <td class="TableStyle-NoBorder8-BodyB-Column1-Body1">
                        <p><a href="mailto:softwaredocs.feedback@weatherford.com?subject=Documentation%20feedback"><img src="../../Resources/Images/Shared Images/Feedback_footer.png" alt="Let us know how we can improve this topic." title="Let us know how we can improve this topic." class="Inline" /></a>
                        </p>
                    </td>
                    <td class="TableStyle-NoBorder8-BodyA-Column1-Body1">
                        <p class="MasterFooterContact"><a href="https://www.weatherford.com/en/products-and-services/production/production-4-0/iot-scada-platform//" target="_blank"><img src="../../Resources/Images/Shared Images/WFT_31x21.png" alt="CygNet at weatherford.com" title="CygNet at weatherford.com" /></a>
                        </p>
                        <p class="MasterFooterContact">© <span class="CygNetVariablesCurrentYear">2020</span> Weatherford. All rights reserved.</p>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>