<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en" xml:lang="en" data-mc-search-type="Stem" data-mc-help-system-file-name="CygNet.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="CygNet Measurement|CygNet Measurement Overview">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>CygNet Measurement Installation</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/HelpTable2.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/NoBorder8.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/HTML5.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><a class="MCBreadcrumbsLink" href="CygNet Measurement.htm">CygNet Measurement</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="CygNet Measurement Overview.htm">CygNet Measurement Overview</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Installation</span>
        </div>
        <h2>Installing CygNet Measurement</h2>
        <p>You can install CygNet Measurement  on an <a href="#ExistingCygNet" class="selected">existing</a> or <a href="#NewCygNet" class="selected">new</a> <span class="CygNetVariablesSoftwareName">CygNet Software</span> installation, or as an <a href="#UpgradeCM" class="selected">upgrade</a> from an earlier version of CygNet Measurement.</p>
        <p class="HeadingProcedure"><a name="ExistingCygNet"></a>To Install CygNet Measurement on an <ins>Existing</ins> <span class="CygNetVariablesSoftwareName">CygNet Software</span> Installation</p>
        <p class="Indent">Follow the procedures and meet the requirements listed and referenced in this document.</p>
        <p class="HeadingProcedure"><a name="NewCygNet"></a>To Install CygNet Measurement with a <ins>New</ins> <span class="CygNetVariablesSoftwareName">CygNet Software</span> Installation</p>
        <p class="Indent">Acquire the proper licenses and install the required version of CygNet Measurement along with all other essential and required <span class="CygNetVariablesSoftwareName">CygNet Software</span> components. </p>
        <p class="Indent">See the <i><a href="../../Resources/PDF_Repository/CygNet_94_Quick_Start.pdf" target="_blank">CygNet Quick Start</a></i> document  or contact <a href="../CygNet Software/Contact CygNet Support.htm" class="MCTopicPopup MCTopicPopupHotSpot a aPopup" title="CygNet Support contact information" data-mc-width="500px" data-mc-height="auto">CygNet Support</a> to  access resources to assist with  initial CygNet Software installation.</p>
        <p class="HeadingProcedure"><a name="UpgradeCM"></a>To Install CygNet Measurement to <ins>Upgrade</ins> an Existing Version of the Application:</p>
        <p class="Indent">Consider additional information in order to upgrade form an earlier to a later version of CygNet Measurement, including details about updating your FMS service database schema in the event of a database change, and updating associated FMS application, template, command, and related files as necessary. </p>
        <p class="Indent">See the <i><a href="../../Resources/PDF_Repository/CygNet_94_Upgrade_Procedure.pdf" target="_blank">CygNet Upgrade Procedure</a></i> for more information.</p>
        <p>The following definitions clarify references to the names CygNet Measurement, FMS, and FMS Explorer.</p>
        <ul>
            <li value="1"><b>CygNet Measurement</b> is the name of the application.</li>
            <li value="2"><b>FMS</b> (Flow Measurement Service) is the name of the underlying CygNet service that is the interface between the Microsoft SQL Server database and the SCADA system.</li>
            <li value="3"><b>FMS Explorer</b> is the name of the primary user client for the CygNet Measurement system.</li>
        </ul>
        <h3>Installing CygNet Measurement on an Existing <span class="CygNetVariablesSoftwareName">CygNet Software</span> Installation</h3>
        <p>Review the following subsections for more information before beginning to install CygNet Measurement.</p>
        <ol>
            <li class="HyperlinkList" value="1"><a href="#1." class="selected">Preliminary Requirements</a>
            </li>
            <li class="HyperlinkList" value="2"><a href="#2." class="selected">Installing Microsoft SQL Server and Databases</a>
            </li>
            <li class="HyperlinkList" value="3"><a href="#3." class="selected">Installing the FMS Service</a>
            </li>
            <li class="HyperlinkList" value="4"><a href="#4." class="selected">Installing and Registering Support Files</a>
            </li>
            <li class="HyperlinkList" value="5"><a href="#5." class="selected">Installing and Registering Optional Database Client and Support Files</a>
            </li>
            <li class="HyperlinkList" value="6"><a href="#6." class="selected">Uploading Files to the APPS Service</a>
            </li>
            <li class="HyperlinkList" value="7"><a href="#7." class="selected">Installing the FMS Explorer Client</a>
            </li>
            <li class="HyperlinkList" value="8"><a href="#8." class="selected">Installing the FMS Toolbox Utility</a>
            </li>
            <li class="HyperlinkList" value="9"><a href="#9" class="selected">Installing the Optional FMS Internal Database Manager Utility</a>
            </li>
        </ol>
        <p>See <a href="Troubleshooting CygNet Measurement.htm#Common">Troubleshooting CygNet Measurement</a> for information about start-up errors that might be encountered during installation.</p>
        <h4><a name="1."></a>1. Preliminary Requirements</h4>
        <p>Before you begin installing CygNet Measurement on an existing <span class="CygNetVariablesSoftwareName">CygNet Software</span> installation, meet the following requirements.</p>
        <h5>Server and Client Requirements</h5>
        <p>Obtain the following information for your system. See the <a href="../../Resources/PDF_Repository/CygNet_94_System_Requirements.pdf" target="_blank"><i>CygNet System Requirements</i></a> document for more information.</p>
        <ul>
            <li class="HyperlinkList" value="1">Microsoft SQL Server information, and Microsoft SQL Server Native Client information (recommended), unless you will be using the FMS&#160;Internal Database. See <a href="FMS Internal Database.htm">Using the FMS&#160;Internal Database</a> for more information about that option.</li>
        </ul>
        <ul class="Circle">
            <li value="1">Microsoft SQL Server - the version depends on the version of CygNet Measurement you are installing and the operating system you are running.</li>
            <li value="2">Microsoft SQL Server Native Client (sqlncli.msi, 32-bit or 64-bit version) -  if you plan to run the Microsoft SQL Server and the FMS service on different physical computers (recommended), the Microsoft SQL Server Native Client is also required to be installed on the computer hosting your FMS service.</li>
        </ul>
        <ul>
            <li value="1">Microsoft .NET Framework information</li>
            <li value="2">Oracle Database Client information - if licensed for CygNet Measurement Repository mode  and using the optional licensed feature set requiring a bi-directional database interface</li>
            <li value="3">SMTP Mail Server information - if used to configure email reporting</li>
        </ul>
        <h5>CygNet Software Requirements</h5>
        <ul>
            <li value="1">Obtain appropriate CygNet Measurement licenses. See <a href="../License Management/License Management.htm">License Management</a> or contact your Account Manager or <a href="../CygNet Software/Contact CygNet Sales.htm" class="MCTopicPopup MCTopicPopupHotSpot a aPopup" title="CygNet Sales contact information" data-mc-width="500px" data-mc-height="auto">CygNet Sales</a> for more information.</li>
            <li value="2">Meet all CygNet Measurement system requirements. See the <a href="../../Resources/PDF_Repository/CygNet_94_System_Requirements.pdf" target="_blank"><i>CygNet System Requirements</i></a> document  for more information.</li>
            <li value="3">Use <span class="CygNetVariablesSoftwareName">CygNet Software</span> v8.5.1 or later as your baseline.
			<div class="Note"><p><span class="NoteHeading">Note:</span> It is highly recommended to use a more recent version of <span class="CygNetVariablesSoftwareName">CygNet Software</span> as your baseline; v8.5.1 is already in limited support and has been superseded by more recent versions containing additional functionality.</p></div></li>
            <li class="HyperlinkList" value="4">Define a CygNetTimeZones.xml file. See <a href="../Date and Time/CygNetTimeZones.xml File.htm">Configuring the CygNetTimeZones.xml File</a> for more information.</li>
            <li value="5">Locate your most recent version of the following CygNet source files.</li>
            <table cellspacing="0" class="TableStyle-HelpTable2" style="mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');margin-left: 0;margin-right: auto;width: 800px;">
                <col class="TableStyle-HelpTable2-Column-Column1" />
                <col class="TableStyle-HelpTable2-Column-Column1" />
                <thead>
                    <tr class="TableStyle-HelpTable2-Head-Header1">
                        <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Folder</th>
                        <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">File Name(s)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="TableStyle-HelpTable2-Body-Body1">
                        <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                            <p>Clients\FmsExplore</p>
                        </td>
                        <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                            <ul>
                                <li value="1">FmsExplore.app</li>
                                <li value="2">FmsExplore.exe</li>
                                <li value="3">FmsExplore.rsp</li>
                                <li value="4">FmsSupp.rsp</li>
                                <li value="5">FmsSupp2.rsp</li>
                            </ul>
                        </td>
                    </tr>
                    <tr class="TableStyle-HelpTable2-Body-Body2">
                        <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                            <p>Clients\Icons</p>
                        </td>
                        <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                            <ul>
                                <li value="1">FmsExplore.ico</li>
                            </ul>
                        </td>
                    </tr>
                    <tr class="TableStyle-HelpTable2-Body-Body1">
                        <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                            <p>Services\ARS</p>
                        </td>
                        <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                            <ul>
                                <li value="1">CygNet.lic (with CygNet Measurement licenses)</li>
                                <li value="2">CygNetTimeZones.xml</li>
                            </ul>
                        </td>
                    </tr>
                    <tr class="TableStyle-HelpTable2-Body-Body2">
                        <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                            <p>Services\FMS</p>
                        </td>
                        <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                            <ul>
                                <li value="1">CreateFmsDatabase.sql</li>
                                <li value="2">fms.cfg</li>
                                <li value="3">Fms.exe</li>
                            </ul>
                        </td>
                    </tr>
                    <tr class="TableStyle-HelpTable2-Body-Body1">
                        <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                            <p>Services\FMS\ImportSamples</p>
                        </td>
                        <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                            <ul>
                                <li value="1">CxFmsImportCsvConfig.idf</li>
                                <li value="2">CxFmsImportCsvGasAnalysis.idf</li>
                                <li value="3">CxFmsImportCsvGasQuality.idf</li>
                                <li value="4">CxFmsImportCsvHistoryGasPeriodic.idf</li>
                                <li value="5">CxFmsImportCsvHistoryTicket.idf</li>
                            </ul>
                        </td>
                    </tr>
                    <tr class="TableStyle-HelpTable2-Body-Body2">
                        <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                            <p>Support</p>
                        </td>
                        <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                            <ul>
                                <li value="1">CxEditors.dll</li>
                                <li value="2">CxFms.dll</li>
                                <li value="3">CxFmsImportCsvConfig.dll*</li>
                                <li value="4">CxFmsImportCsvHistory.dll*</li>
                                <li value="5">CxFmsImportEmersonROC.dll*</li>
                                <li value="6">CxFmsImportToFlo.dll*</li>
                                <li value="7">CxFmsStandardReport.dll*</li>
                                <li value="8">CxHmiFms.ocx</li>
                                <li value="9">CxXlsxViewer.ocx</li>
                                <li value="10">CygMeasCalc.dll</li>
                                <li value="11">FmsValidationEngine.dll</li>
                            </ul>
                        </td>
                    </tr>
                    <tr class="TableStyle-HelpTable2-Body-Body1">
                        <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                            <p>System</p>
                        </td>
                        <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                            <ul>
                                <li value="1">PEGrp32E.dll</li>
                                <li value="2">XlsxViewer.msi</li>
                            </ul>
                        </td>
                    </tr>
                    <tr class="TableStyle-HelpTable2-Body-Body2">
                        <td class="TableStyle-HelpTable2-BodyB-Column1-Body2">
                            <p>Utilities</p>
                        </td>
                        <td class="TableStyle-HelpTable2-BodyA-Column1-Body2">
                            <ul>
                                <li value="1">FmsToolbox.app</li>
                                <li value="2">FmsToolbox.exe</li>
                                <li value="3">FmsToolbox.ico</li>
                                <li value="4">FmsToolbox.rsp</li>
                                <li value="5">FmsInternalDatabaseMgr.exe (optional)</li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </ul>
        <div class="Note">
            <p><span class="NoteHeading">*Note:</span> This file is not supported for use outside the run-time environment of the FMS Service.</p>
        </div>
        <p>Once you have met the above requirements and are ready to proceed, go to <a href="#2." class="selected">2. Installing Microsoft SQL Server and Databases</a>.</p><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h4><a name="2."></a>2. Installing Microsoft SQL Server, Native Client, and Databases</h4>
        <p>Before installing CygNet Measurement, you must install the Microsoft SQL Server and create a database for your FMS service (unless your installation will use the FMS internal database. See <a href="FMS Internal Database.htm">Using the FMS Internal Database</a> for more information about database selection).</p>
        <ul>
            <li value="1">If you are already using Microsoft SQL Server, you must create a new database  to be your FMS&#160;SQL Server database. </li>
            <li value="2">If you are not yet using SQL Server, you must install SQL Server and then create a database to be your FMS&#160;SQL Server database. </li>
            <li value="3"><span class="CygNetVariablesSoftwareName">CygNet Software</span> provides a SQL script to create the database, but does not distribute a database file.</li>
            <li value="4">If you are planning to run the Microsoft SQL Server and the FMS&#160;service on different physical computers (recommended), you must also install Microsoft SQL Server Native Client on the computer hosting your FMS service.</li>
        </ul>
        <div class="Note">
            <p><span class="NoteHeading">Note:</span> Although CygNet Measurement maintains a full audit trail for device data, there is no inherent audit trail in SQL. This means that editing  data directly in SQL provides no audit trail of those edits, therefore it is important that only SQL administrators should have access to the SQL database.</p>
        </div>
        <p class="HeadingProcedure">To Install Microsoft SQL&#160;Server and Databases</p>
        <ol>
            <li value="1">Properly install Microsoft SQL Server, if you are not already using it. Refer to  <a href="http://msdn.microsoft.com/en-us/library/bb545450.aspx" target="_blank">Microsoft SQL Server</a> online documentation for more information and instructions.</li>
            <li value="2">If you plan to run the Microsoft SQL Server and the FMS service on different physical computers, install Microsoft SQL Server Native Client (sqlncli.msi, 32-bit or 64-bit version) on the computer hosting your FMS service (your service computer).  Install with Administrator rights. Refer to <a href="https://docs.microsoft.com/en-us/sql/relational-databases/native-client/applications/installing-sql-server-native-client?view=sql-server-2017" target="_blank">Microsoft SQL Server Native Client</a> online documentation for more information and instructions.</li>
            <li value="3">Create a new database to serve only as your FMS SQL Server database. The FMS Service requires a one-to-one relationship with the FMS SQL Server database, therefore the account running the FMS&#160;Service needs read/write access to the designated FMS SQL Server database and its tables plus the ability to create or modify tables.
			 <p>Ensure that the FMS SQL Server database remains pristine by instituting security measures that allow database permissions only to the FMS Service and authorized SQL database administrators. Contact your system administrator or refer to Microsoft online documentation  at <a href="http://msdn.microsoft.com/" target="_blank">http://msdn.microsoft.com/</a> for more information about current permission settings for Microsoft SQL Server.</p><div class="Note"><p><span class="NoteHeading">Note:</span> FMS needs no additional SQL Server database permissions beyond those required to fully access the single SQL Server database created for FMS.</p></div></li>
        </ol>
        <ol class="Lower_alpha">
            <li value="1">Open Microsoft SQL Server Management Studio (SMSS).</li>
        </ol>
        <ol class="Lower-roman">
            <li value="1">Locate the server that will contain your new FMS database and click <b>Connect</b>.</li>
            <li value="2">Expand <b>Databases</b> in the Object Explorer, right-click <b>Databases</b>, click <b>New Database</b>, and enter a <b>Database name</b>. Make any other settings changes required and then click <b>OK</b>. See <a href="#NoteSSMS" class="selected">Note</a> below.</li>
            <li value="3">In the Object Explorer, select your new FMS database and then click <b>File</b> &gt; <b>Open</b> &gt; <b>File</b>.</li>
        </ol>
        <ol class="Lower_alpha">
            <li value="1">In your CygNet Measurement source files, browse to the <b>CreateFmsDatabase.sql</b> file in the <b>CygNet\Services\FMS</b> folder and click <b>Open</b>.</li>
        </ol>
        <ol class="Lower-roman">
            <li value="1">At the top of the CreateFmsDatabase.sql file, in the [<i>YourDatabaseNameHere</i>] placeholder, type the name of your new CygNet Measurement (FMS) database and click <b>Execute</b>.</li>
            <li value="2">When your query executes successfully, <b>Save</b> and exit Microsoft SQL Server Management Studio.</li>
        </ol>
        <div class="Note"><a name="NoteSSMS"></a>
            <p><span class="NoteHeading">Note:</span> If you find it necessary to disable the capability to create or modify database tables for the SQL Server database manager tool, the disabled capability must be temporarily restored any time a database update is done so that table schemes can be modified and the system can be kept current. Such capabilities can again be disabled if necessary once each database update is complete.</p>
        </div>
        <p>Once Microsoft SQL&#160;Server has been set up and an FMS database has been created, go to <a href="#3." class="selected">3. Installing the  FMS Service</a>.</p><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h4><a name="3."></a>3. Installing the FMS Service</h4>
        <p>Follow this procedure to install and activate FMS so that it is displayed in CygNet Explorer and interacts with other core CygNet SCADA services and the SQL database.</p>
        <p class="HeadingProcedure">To Install the FMS Service</p>
        <ol>
            <li value="1">Open <b>CygNet Host Manager</b>, and locate the Remote Service Manager (RSM) for the site to which you are adding FMS. The FMS service and RSM service must be on the same computer. </li>
        </ol>
        <ol class="Lower_alpha">
            <li value="1">Select the RSM service from the list on the <b>Service Status</b> tab and then click <b>Stop</b> to stop the service. </li>
            <li value="2">Once the service has stopped, click <b>File</b> and then <b>Exit CygNet Host Manager</b> to exit CygNet Host Manager.</li>
        </ol>
        <ol start="2">
            <li value="2">Using Windows Explorer, locate the <b>CygNet\Services\ARS</b> folder on your host server.</li>
        </ol>
        <ol class="Lower_alpha">
            <li value="1">Copy your <a href="Licensing Requirements.htm">new CygNet.lic file</a> into the folder. It must overwrite any existing CygNet.lic file.</li>
            <li value="2">Copy a properly defined <a href="../Date and Time/CygNetTimeZones.xml File.htm">CygNetTimeZones.xml file</a> into the folder.</li>
        </ol>
        <ol start="3">
            <li value="3">Copy the <b>FMS</b> folder from your source to the <b>CygNet\Services</b> folder on your host server. This folder must include at least the following files.</li>
        </ol>
        <ul class="Circle">
            <li value="1">fms.cfg</li>
            <li value="2">Fms.exe</li>
        </ul>
        <ol start="4">
            <li value="4">In the <b>CygNet\Services\FMS</b> folder on your host server, open the <b>fms.cfg</b> file in a text editor. </li>
        </ol>
        <ol class="Lower_alpha">
            <li value="1">Replace <i>XXX</i> with your site name for all relevant services. </li>
            <li value="2">Update the DB_SERVER <a href="../Service Configuration Keywords/FMS Configuration File Keywords.htm#DatabaseInfoKeywords">keyword</a> with the name of the computer hosting your SQL database. </li>
            <li value="3">Update the DB_CATALOG <a href="../Service Configuration Keywords/FMS Configuration File Keywords.htm#DatabaseInfoKeywords">keyword</a> with the name of the database you've created for this FMS service. </li>
            <li value="4">Depending on your method of authentication, you might need to set the DB_USERNAME and DB_PASSWORD <a href="../Service Configuration Keywords/FMS Configuration File Keywords.htm#DatabaseInfoKeywords">keywords</a>. </li>
            <li value="5"><b>Save</b> the configuration file and exit.</li>
        </ol>
        <ol start="5">
            <li value="5">In order to send reports via email, you must add SMTP keyword values to the FMS configuration file. See <a href="../Service Configuration Keywords/FMS Configuration File Keywords.htm#Email">Email Info Keywords</a> and <a href="Configuring Email Options.htm">Configuring Email Options</a> for more information.</li>
            <li value="6">In the <b>CygNet\Services</b> folder on your host server, open the <b>UIS</b> folder.</li>
        </ol>
        <ol class="Lower_alpha">
            <li value="1">Open the <b>Uis.cfg</b> file in a text editor.</li>
            <li value="2">In the <b>Associated Services</b> section of the Uis.cfg file, delete the pound sign (#) from in front of <b>FMS</b>.</li>
            <li value="3">For multiple FMS services, add the additional <i>Site.Service</i> name(s) to the <b>FMS</b> line, separated by spaces.</li>
            <li value="4"><b>Save</b> the configuration file and exit.</li>
        </ol>
        <ol start="7">
            <li value="7">Open <b>CygNet Host Manager</b> and start the Remote Service Manager (RSM) for the site to which you are adding FMS.</li>
            <li value="8">Using CygNet Explorer, open the <b>Access Control Service</b> (ACS) to configure security for the FMS service.</li>
        </ol>
        <ol class="Lower_alpha">
            <li value="1">Add a new FMS application. See <a href="../Security/Configuring Applications and Events.htm">To Add an Application</a> for more information.</li>
            <li value="2">Add security events and permissions to the new application. See <a href="../Security/Configuring Applications and Events.htm">To Add an Event to an Application</a> and <a href="FMS Security.htm">FMS Security</a> for more information. Security events are as follows.</li>
            <ul class="Circle">
                <li value="1">ACCESS</li>
                <li value="2">CLOSE</li>
                <li value="3">CMDDEV</li>
                <li value="4">CMDSYS</li>
                <li value="5">DEVALA</li>
                <li value="6">DEVCFG</li>
                <li value="7">EXCP</li>
                <li value="8">JOB</li>
                <li value="9">NODE</li>
                <li value="10">PPA</li>
                <li value="11">SVCINFO</li>
                <li value="12"><i>&lt;custom&gt;</i>
                </li>
            </ul>
        </ol>
        <ol start="9">
            <li value="9">In order to publish normalized data to the CygNet SCADA system, you must add the FMS service to the <b>ADMINS</b> group in the ACS, to provide appropriate security for the FMS service to make updates to the UIS and the VHS services. The following steps describe how to build this security configuration.</li>
        </ol>
        <ol class="Lower_alpha">
            <li value="1">In the ACS, click the <b>Groups</b> tab or right-click in the white space of the service window and click <b>View Groups</b>.</li>
            <li value="2">Right-click in the white space of the service pane and click <b>New Group</b>.</li>
            <li value="3">In the <b>Group</b> text box, type an ID for the FMS service group, e.g. SVC_FMS.</li>
            <li value="4">In the <b>Description</b> text box, type a description for the group, e.g. FMS Group.</li>
            <li value="5">Add a Group Member.</li>
        </ol>
        <ol class="Lower-roman">
            <li value="1">In the Group Members area, click <b>New</b>.</li>
            <li value="2">Select  <b>US - User</b> as the Security ID <b>Type</b>.</li>
            <li value="3">Type "FMS" as the <b>User</b>.</li>
            <li value="4">Click <b>OK</b> twice.</li>
        </ol>
        <ol class="Lower_alpha" start="6">
            <li value="6">Add the FMS service group to the SERVICES group. </li>
        </ol>
        <ol class="Lower-roman">
            <li value="1">Double-click one of the SERVICES listings. Click <b>View Group</b>.</li>
            <li value="2">In the Group Members area, click <b>New</b>.</li>
            <li value="3">Select <b>CG - CygNet Group</b> as the Security ID <b>Type</b>.</li>
            <li value="4">Type the <b>Group</b>, e.g. SVC_FMS.</li>
            <li value="5">Click <b>OK</b> twice.</li>
        </ol>
        <ol class="Lower_alpha" start="7">
            <li value="7">Verify that the SERVICES group is a member of the <b>ADMINS</b> group. </li>
        </ol>
        <ol class="Lower-roman">
            <li value="1">Double-click the ADMINS SERVICES group. </li>
            <li value="2">Click <b>View Group</b>. </li>
            <li value="3">Confirm that SERVICES is a member.</li>
            <li value="4">If not, add it as described in step f.</li>
            <li value="5">Click <b>OK</b>.</li>
        </ol>
        <ol start="10">
            <li value="10">In CygNet Explorer, open your <b>Address Resolution Service</b> (ARS).</li>
        </ol>
        <ol class="Lower_alpha">
            <li value="1">Right-click in the white space of the service pane and click <b>New</b>.</li>
            <li value="2">Select <b>FMS</b> from the <b>Service Type</b> drop-down menu, enter a <b>Site</b> and a <b>Description</b>, and then click <b>OK</b>.</li>
        </ol>
        <ol start="11">
            <li value="11">In CygNet Explorer, open your Remote Service Manager (RSM).</li>
        </ol>
        <ol class="Lower_alpha">
            <li value="1">Right-click in the white space of the RSM service pane and click <b>New</b>.</li>
            <li value="2">Select the newly added FMS service from the <b>Service Name</b> list. Do not start the newly added FMS service yet. The RSM and FMS must be in the same <b>CygNet\Services</b> folder.  In the <b>Directories</b> section of the dialog box, verify or enter the correct <b>Executable</b> path and <b>Data</b> path for FMS.</li>
            <li value="3">Click <b>OK</b>.</li>
        </ol>
        <div class="Note">
            <p><span class="NoteHeading">Note:</span> Check  the permissions in the user account associated with your FMS service. For FMS SVCMON and Replication status checks to succeed, proper table permissions must be set. Refer to Microsoft online documentation at <a href="http://msdn.microsoft.com/" target="_blank">http://msdn.microsoft.com/</a> for more information about IDENTITY_INSERT and table permission settings for Microsoft SQL Server.</p>
        </div>
        <p>Once the FMS&#160;service has been installed on your existing CygNet system, go to <a href="#4." class="selected">4. Installing and Registering Support Files</a>.</p><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h4><a name="4."></a>4. Installing and Registering Support Files for the FMS Service</h4>
        <p>Follow this procedure to install and register CygNet Measurement support files for your FMS Service.</p>
        <p class="HeadingProcedure">To Install and Register Support Files for the FMS Service</p>
        <ol>
            <li value="1">Using Windows Explorer, locate the following support files in your source and copy them to the <b>Support</b> folder on your host server.</li>
            <ul class="Circle">
                <li value="1">CxFms.dll</li>
                <li value="2">CxFmsImportCsvConfig.dll</li>
                <li value="3">CxFmsImportCsvHistory.dll</li>
                <li value="4">CxFmsImportEmersonROC.dll</li>
                <li value="5">CxFmsImportToFlo.dll</li>
                <li value="6">CxFmsStandardReport.dll</li>
                <li value="7">CXHMIFMS.OCX</li>
                <li value="8">CYGMEASCALC.DLL</li>
                <li value="9">FMSVALIDATIONENGINE.DLL</li>
            </ul>
            <li value="2">For <u>each</u> of the copied files, right-click the file, and then click <b>Open</b>. You might first have to choose a program with which to open and register the files. If so, browse to the <b>Windows\System32</b> directory and double-click <b>regsvr32.exe</b> on a 32-bit operating system (use <b>Windows\SysWOW64\regsvr32.exe</b> on a 64-bit operating system).</li>
            <li value="3">In CygNet Explorer, open your RSM, right-click on the newly installed FMS service, and click <b>Start</b>.</li>
            <li value="4"> In your source files, locate the <b>StudSupp.rsq</b> file in the <b>CygNet\Support</b> folder and do the following.
            <ol class="Lower_alpha"><li value="1">Download the file from the APPS BLOB, and make the following modifications.</li><ol class="Lower-roman"><li value="1">In the linked .rsp files section, add the line <code>[SUPPORT]..\SUPPORT\FmsSupp.rsp</code>.</li><li value="2">Add the line <code>[SUPPORT]..\SUPPORT\FmsSupp2.rsp</code>.</li><li value="3"><b>Save</b> and close the file.</li></ol><li value="2">Upload the edited file to the APPS BLOB. See <a href="../BLOB Storage Service/BLOB Storage Service.htm">Blob Storage Service</a> for more information.</li></ol></li>
        </ol>
        <p>If you experience start-up errors, see <a href="Troubleshooting CygNet Measurement.htm#Common">Common Start-up Errors</a> for troubleshooting help.</p>
        <p>Once your FMS service is installed and running within the CygNet system, if you will be installing optional functionality go to <a href="#5." class="selected">5. Installing and Registering Optional Support Files</a> , otherwise go to <a href="#6." class="selected">6. Uploading Files to the APPS Service</a>. </p>
        <h4><a name="5."></a>5. Installing and Registering Optional Database Client and Support Files</h4>
        <p>Certain FMS functionality is provided as an optional licensed feature set.  If your system license includes this feature set,  both  an Oracle database client and manual installation and registration of corresponding CygNet Measurement support files are required to access the feature set. Use the following procedures to use this optional functionality.</p>
        <p>Before installing the optional files, you must have access to an Oracle database connection that is compatible with your system, and that is located on the same host computer as your FMS Service. The following steps explain how to provide the required database client for your host computer.</p>
        <p class="HeadingProcedure">To Install the Oracle Database Client</p>
        <div class="Note">
            <p><span class="NoteHeading">Note:</span>  Refer to Oracle Database Client/Flow-Cal documentation and/or contact your Oracle/Flow-Cal representatives for the most current information about specific installation details.</p>
        </div>
        <ol>
            <li value="1">Verify or perform installation of a compatible Oracle Database Client (32-bit version) on the computer hosting your FMS service (your client computer).   For installation type, select the <b>Administrator</b> option.</li>
            <li value="2">Restart your client computer.</li>
            <li value="3">Verify the database connection.</li>
            <li value="4">In the <b>CygNet\Services\FMS</b> folder on your host server, open the FMS configuration file (<b>fms.cfg</b>) and configure the Database Info service configuration keywords for your Flow-Cal database connection. See <a href="../Service Configuration Keywords/FMS Configuration File Keywords.htm#DatabaseInfoKeywords">FMS Configuration File Keywords</a> for more information.</li>
        </ol>
        <p>Once the Oracle database client installation is complete,  install and register the optional support files. The following steps explain how to manually install and register the corresponding CygNet Measurement support files for your FMS Service.</p>
        <p class="HeadingProcedure">To Install and Register Optional Support Files: Flow-Cal Data Export Commands</p>
        <ol>
            <li value="1">On your host server, do the following.</li>
        </ol>
        <ol class="Lower_alpha">
            <li value="1">Copy the driver file (<b>CxFmsFlowCalExport.dll</b>) from the <b>CygNet\Support</b> folder in the <span class="CygNetVariablesSoftwareName">CygNet Software</span> source files to the <b>CygNet\Support</b> folder on your host server.</li>
            <li value="2">Open and register the copied file as follows.  Browse to the <b>Windows\System32</b> directory and double-click to open  <b>regsvr32.exe</b> (on a 64-bit operating system, use <b>Windows\SysWOW64\regsvr32.exe</b>) to register the file. A confirmation message will appear when registration is complete.</li>
            <li value="3">Copy the sample command definition file(s), SampleExportFlowCal.cdf,    and/or SampleExportFlowCalDB.cdf, and/ or SampleExportFlowCalTicket.cdf, from the <b>CygNet\Services\Fms</b> folder in the <span class="CygNetVariablesSoftwareName">CygNet Software</span> source files to the <b>CygNet\Services\Fms\CommandDefs</b> folder on your host server.</li>
            <li value="4">Remove the word "Sample" from the file name(s) you have placed in the  <b>CommandDefs</b> folder, so the name reads "ExportFlowCal.cdf" and/or "ExportFlowCalDB.cdf" and/or "ExportFlowCalTicket.cdf" and the file(s) will be recognized by the FMS service. </li>
            <li value="5">Optionally edit or customize the command definition file(s). See the corresponding "Export: Flow-Cal ... Commands" configuration topics in the <a href="Managing Node Commands.htm">Managing Node Commands</a> section for more information about editing and customizing the command definition files for each export command used.</li>
        </ol>
        <ol start="2">
            <li value="2">In CygNet Explorer, do the following.</li>
        </ol>
        <ol class="Lower_alpha">
            <li value="1">Open the <b>RSM</b> (Remote Service Manager) and right-click on your <b>FMS</b> (Flow Measurement Service) <i>Site.Service</i> to access the context menu. </li>
            <li value="2">Click <b>Restart</b> to restart your FMS Service. </li>
            <li value="3">The selected export commands will now be displayed in FMS command selection dialogs in your application. See <a href="FMS Commands.htm">FMS Commands</a> for more information.</li>
        </ol><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <h4><a name="6."></a>6. Uploading Files to the APPS Service</h4>
        <p>Upload the following files to your APPS service (the BLOB storage service that stores your CygNet client application files), so that applications installed using the CygNet Client Installer (e.g. steps 7 and 8) can be provided with integrated version management. See <a href="../Version Management/Version Management.htm">Version Management</a> for more information.</p>
        <p class="HeadingProcedure">To Upload Files to the APPS Service</p>
        <ul>
            <li value="1">To enable version management of your applications (recommended) by using the CygNet Client Installer,  upload the files listed in the following table to the APPS Service using BSS Explorer. See <a href="../BLOB Storage Service/BSS Explorer.htm">BSS Explorer</a> for more information about using the BSS Explorer to upload files. </li>
            <table cellspacing="0" class="TableStyle-HelpTable2" style="mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');margin-left: 0;margin-right: auto;width: 800px;">
                <col class="TableStyle-HelpTable2-Column-Column1" />
                <col class="TableStyle-HelpTable2-Column-Column1" />
                <thead>
                    <tr class="TableStyle-HelpTable2-Head-Header1">
                        <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Target APPS Folder</th>
                        <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">File Name(s)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="TableStyle-HelpTable2-Body-Body1">
                        <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                            <p>Clients\FmsExplore</p>
                        </td>
                        <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                            <ul>
                                <li value="1">FmsExplore.app</li>
                                <li value="2">FmsExplore.exe</li>
                                <li value="3">FmsExplore.rsp</li>
                                <li value="4">FmsSupp.rsp</li>
                                <li value="5">FmsSupp2.rsp</li>
                            </ul>
                        </td>
                    </tr>
                    <tr class="TableStyle-HelpTable2-Body-Body2">
                        <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                            <p>Clients\Icons</p>
                        </td>
                        <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                            <ul>
                                <li value="1">FmsExplore.ico</li>
                            </ul>
                        </td>
                    </tr>
                    <tr class="TableStyle-HelpTable2-Body-Body1">
                        <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                            <p>Support</p>
                        </td>
                        <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                            <ul>
                                <li value="1">CxEditors.rsp</li>
                                <li value="2">CxHmiFms.ocx</li>
                                <li value="3">CxFms.dll</li>
                                <li value="4">CxXlsxViewer.ocx</li>
                                <li value="5">CygMeasCalc.dll</li>
                                <li value="6">FileConverter.exe</li>
                                <li value="7">FmsValidationEngine.dll</li>
                            </ul>
                        </td>
                    </tr>
                    <tr class="TableStyle-HelpTable2-Body-Body2">
                        <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                            <p>System</p>
                        </td>
                        <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                            <ul>
                                <li value="1">PEGrp32E.dll</li>
                                <li value="2">XlsxViewer.msi</li>
                            </ul>
                        </td>
                    </tr>
                    <tr class="TableStyle-HelpTable2-Body-Body1">
                        <td class="TableStyle-HelpTable2-BodyB-Column1-Body1">
                            <p>Utilities</p>
                        </td>
                        <td class="TableStyle-HelpTable2-BodyA-Column1-Body1">
                            <ul>
                                <li value="1">FmsToolbox.app</li>
                                <li value="2">FmsToolbox.exe</li>
                                <li value="3">FmsToolbox.ico</li>
                                <li value="4">FmsToolbox.rsp</li>
                                <li value="5">FmsInternalDatabaseMgr.exe (optional)</li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </ul>
        <p>Once the required files are present in your APPS service, you can install the FMS Explorer client and the FMS Toolbox utility, using the CygNet Client Installer to set up integrated version management (and optionally the <a href="FMS Internal Database Manager Utility.htm">FMS Internal Database Manager utility</a>, if using that option). Go to <a href="#7." class="selected">7. Installing the FMS Explorer Client</a> and <a href="#8." class="selected">8. Installing the FMS Toolbox Utility</a>.</p>
        <h4><a name="7."></a>7. Installing the FMS Explorer Client</h4>
        <p>FMS Explorer is the primary user interface for the CygNet Measurement application. It provides both administrative and user functionality. Once the required files are present in the APPS service, FMS Explorer can be installed using the CygNet Client Installer.</p>
        <p class="HeadingProcedure">To Install the FMS Explorer Client</p>
        <ul>
            <li value="1">To install the FMS Explorer client, see <a href="Installing and Starting FMS Explorer.htm">Installing and Starting FMS Explorer</a>.</li>
        </ul>
        <h4><a name="8."></a>8. Installing the FMS Toolbox Utility</h4>
        <p>FMS Toolbox is a CygNet provided set of tools  for importing data into the CygNet Measurement application, from within or outside the FMS system.  Once the required files are present in the APPS service, FMS Toolbox can be installed using the CygNet Client Installer.</p>
        <p class="HeadingProcedure">To Install the FMS Toolbox Utility</p>
        <ul>
            <li value="1">To install the FMS Toolbox utility, see <a href="Installing and Starting FMS Toolbox.htm">Installing and Starting FMS Toolbox</a>.</li>
        </ul>
        <h4><a name="9"></a>9. (Optional) Installing the FMS Internal Database Manager Utility</h4>
        <p>FMS Internal Database Manager is a CygNet provided utility  for managing the CygNet Measurement database, when using the FMS Internal Database option. Use the utility to retrieve records from the internal database using SQL queries, and to copy and save results as CSV files.  </p>
        <p class="HeadingProcedure">To Install the FMS Internal Database Manager Utility</p>
        <ul>
            <li value="1">To install the FMS Internal Database Manager utility, see <a href="FMS Internal Database Manager Utility.htm">FMS Internal Database Manager Utility</a>.</li>
        </ul><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <hr width="100%" size="1" />
        <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/NoBorder8.css');" summary="MasterFooter" class="TableStyle-NoBorder8" cellspacing="0">
            <col class="TableStyle-NoBorder8-Column-Column1" />
            <col class="TableStyle-NoBorder8-Column-Column1" />
            <tbody>
                <tr class="TableStyle-NoBorder8-Body-Body1">
                    <td class="TableStyle-NoBorder8-BodyB-Column1-Body1">
                        <p><a href="mailto:softwaredocs.feedback@weatherford.com?subject=Documentation%20feedback"><img src="../../Resources/Images/Shared Images/Feedback_footer.png" alt="Let us know how we can improve this topic." title="Let us know how we can improve this topic." class="Inline" /></a>
                        </p>
                    </td>
                    <td class="TableStyle-NoBorder8-BodyA-Column1-Body1">
                        <p class="MasterFooterContact"><a href="https://www.weatherford.com/en/products-and-services/production/production-4-0/iot-scada-platform//" target="_blank"><img src="../../Resources/Images/Shared Images/WFT_31x21.png" alt="CygNet at weatherford.com" title="CygNet at weatherford.com" /></a>
                        </p>
                        <p class="MasterFooterContact">© <span class="CygNetVariablesCurrentYear">2020</span> Weatherford. All rights reserved.</p>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>