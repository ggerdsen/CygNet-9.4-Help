<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en" xml:lang="en" data-mc-search-type="Stem" data-mc-help-system-file-name="CygNet.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="OPC|OPC Interface Service|Setting up an OPCIS">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Configuring and Starting the OPCIS</title>
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Resources/TableStyles/HelpTable2.css" rel="stylesheet" />
        <link href="../../Resources/TableStyles/NoBorder8.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/HTML5.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><a class="MCBreadcrumbsLink" href="OPC.htm">OPC</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="OPC Interface Service.htm">OPC Interface Service</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="OPCIS - Setting Up.htm">Setting up an OPCIS</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Configuring and Starting the OPCIS</span>
        </div>
        <h2>Configuring and Starting the OPCIS</h2>
        <p>The tasks required to add an OPCIS to your CygNet site are the same as adding any other type of service. Note that when adding the service to the ARS the <b>Service Type</b> is <b>CVS</b>.</p>
        <h3><a name="OPCIS"></a>OPCIS Configuration File</h3>
        <p>In addition to the standard current value service keywords, the OPCIS configuration file contains additional keywords used to define the connection to the OPC server. Note that some of the configuration file keyword settings can be overridden by the corresponding point attributes. </p>
        <p>For example, if the configuration file keyword <b>OPC_SERVER</b> is set to <b>Server1</b>, and the point’s <b>External ID</b> field is set to <b>server_name=Server2</b> then the connection for that group will be to <b>Server2</b>. </p>
        <p>See <a href="../Service Configuration Keywords/OPCIS Configuration File Keywords.htm">OPCIS Configuration File Keywords</a> for a complete list of keywords.</p>
        <table style="caption-side: top;margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/HelpTable2.css');width: 800px;" class="TableStyle-HelpTable2" cellspacing="0">
            <col style="width: 210px;" class="TableStyle-HelpTable2-Column-Column1" />
            <col class="TableStyle-HelpTable2-Column-Column1" />
            <thead>
                <tr class="TableStyle-HelpTable2-Head-Header1">
                    <th class="TableStyle-HelpTable2-HeadE-Column1-Header1">Keyword</th>
                    <th class="TableStyle-HelpTable2-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>OPC_HEALTHCHECK_RATE</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>When the OPC_IO_TYPE is ASYNC, a synchronous retrieval is performed periodically as a health check. This keyword specifies the frequency  in milliseconds, at which the OPCIS will send a health check to the OPC server.</p>
                    <p>See <a href="OPCIS Health Check.htm">OPCIS Health Check</a> for more information.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>OPC_IO_TYPE</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>Specifies the type of communications between the OPCIS and the OPC server (ASYNC or SYNC).</p>
                    <div class="Note">
                        <p><span class="NoteHeading">Note:</span> You can set the OPC_IO_TYPE by group by setting point configuration attributes. See <a href="OPCIS Groups.htm">OPCIS Groups</a> for more information.</p>
                    </div>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>OPC_MACHINE_NAME</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>Specifies the name of the remote computer on which the OPC server is running. Both UNC (for example, \\SERVER or SERVER) and DNS (for example, server.com or IP address) formats are acceptable.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>OPC_MAX_UPDATE</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>Depends on the communications type (OPC_IO_TYPE). Value is in milliseconds.</p>
                    <ul class="table">
                        <li value="1">ASYNC — The maximum rate the OPC server can push changed values to the OPCIS.</li>
                        <li value="2">SYNC — The rate at which the OPCIS requests data from the OPC server.</li>
                    </ul>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>OPC_SERVER</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>Specifies the name of the OPC server (either the PROGID or CLSID from the registry). The name is case sensitive. The name must be enclosed in quotation marks if it contains spaces.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>OPC_STARTUP_DELAY</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>Specifies the time (in milliseconds) that the OPCIS delays at startup before sending messages to the OPC server.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body1">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body1">
                    <p>OPC_SYNC_IO</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body1">
                    <p>Specifies whether the OPC server retrieves data from the device or cache. Applies to all synchronous communication.</p>
                </td>
            </tr>
            <tr class="TableStyle-HelpTable2-Body-Body2">
                <td class="TableStyle-HelpTable2-BodyE-Column1-Body2">
                    <p>PERSIST_FILE_REFRESH_RATE</p>
                </td>
                <td class="TableStyle-HelpTable2-BodyD-Column1-Body2">
                    <p>Specifies the rate (in minutes) at which to write current persisted values to the CVS.Persist.dat file.</p>
                </td>
            </tr>
        </table>
        <p>By default, other standard CVS keywords are commented out. These are: CAS, GNS, TRS, and VHS. Uncomment these if you want OPCIS tags to alarm, notify, or report data.</p>
        <div class="Note">
            <p><span class="NoteHeading">Note:</span> When using OPCIS tunnelling software such as the MatrikonOPC Tunneller client, both the <b>OPC_SERVER</b> and <b>OPC_MACHINE_NAME</b> keywords must be uncommented and specified in the Opcis.cfg file.</p>
        </div>
        <h3>Verifying OPCIS Startup</h3>
        <p>Once the OPCIS has been started you can use the <a href="../CygNet Console/CygNet Console.htm">CygNet Console</a> to look at the service screen and verify connectivity to the OPC server. The <b>System</b> screen (F2) and the <b>Trace</b> screen (F3) will show information about the connection.</p><a href="#top" class="selected"><img src="../../Resources/Images/Shared Images/Arrow_top.png" style="float: right;padding-top: 6px;padding-right: 2px;padding-bottom: 2px;" title="Back to top" alt="Back to top" /></a>
        <hr width="100%" size="1" />
        <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/NoBorder8.css');" summary="MasterFooter" class="TableStyle-NoBorder8" cellspacing="0">
            <col class="TableStyle-NoBorder8-Column-Column1" />
            <col class="TableStyle-NoBorder8-Column-Column1" />
            <tbody>
                <tr class="TableStyle-NoBorder8-Body-Body1">
                    <td class="TableStyle-NoBorder8-BodyB-Column1-Body1">
                        <p><a href="mailto:softwaredocs.feedback@weatherford.com?subject=Documentation%20feedback"><img src="../../Resources/Images/Shared Images/Feedback_footer.png" alt="Let us know how we can improve this topic." title="Let us know how we can improve this topic." class="Inline" /></a>
                        </p>
                    </td>
                    <td class="TableStyle-NoBorder8-BodyA-Column1-Body1">
                        <p class="MasterFooterContact"><a href="https://www.weatherford.com/en/products-and-services/production/production-4-0/iot-scada-platform//" target="_blank"><img src="../../Resources/Images/Shared Images/WFT_31x21.png" alt="CygNet at weatherford.com" title="CygNet at weatherford.com" /></a>
                        </p>
                        <p class="MasterFooterContact">© <span class="CygNetVariablesCurrentYear">2020</span> Weatherford. All rights reserved.</p>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>